"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.cleanSharedModuleSet=cleanSharedModuleSet,exports.collectSharedModule=collectSharedModule,exports.sharedModuleSet=void 0;var _typescript=_interopRequireDefault(require("typescript")),_ark_define=require("./common/ark_define"),_utils=require("../../utils"),_main=require("../../../main");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}const sharedModuleSet=new Set;function collectSharedModule(e,t,r){for(const i of(r=r||_typescript.default.createSourceFile(t,e,_typescript.default.ScriptTarget.Latest,!0,_typescript.default.ScriptKind.ETS)).statements)if(!_typescript.default.isImportDeclaration(i))return void(_typescript.default.isExpressionStatement(i)&&_typescript.default.isStringLiteral(i.expression)&&i.expression.text===_ark_define.USE_SHARED&&(sharedModuleSet.add((0,_utils.toUnixPath)(t)),processDeclarationFile(t)))}function processDeclarationFile(e){(_main.projectConfig.compileHar||_main.projectConfig.compileShared)&&(e=_utils.harFilesRecord.get((0,_utils.toUnixPath)(e)))&&(e.originalDeclarationContent=_ark_define.USE_SHARED_COMMENT+"\n"+e.originalDeclarationContent)}function cleanSharedModuleSet(){sharedModuleSet.clear()}exports.sharedModuleSet=sharedModuleSet;