"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.genAbc=genAbc;var _process_ark_config=require("./common/process_ark_config"),_generate_bundle_abc=require("./generate_bundle_abc"),_generate_module_abc=require("./generate_module_abc"),_transform=require("./transform"),_cache=require("./cache"),_check_import_module=require("./check_import_module"),_check_shared_module=require("./check_shared_module"),_ets_checker=require("../../ets_checker"),_module_source_file=require("./module/module_source_file"),_generate_sourcemap=require("./generate_sourcemap"),_ark_utils=require("../../ark_utils"),_process_kit_import=require("../../process_kit_import"),_utils=require("./utils");function _newArrowCheck(e,r){if(e!==r)throw new TypeError("Cannot instantiate an arrow function")}function genAbc(){var e=this;return{name:"genAbc",buildStart(){this.share.arkProjectConfig=(0,_process_ark_config.initArkProjectConfig)(this.share),(0,_cache.checkArkCompilerCacheInfo)(this),_generate_sourcemap.SourceMapGenerator.init(this)},shouldInvalidCache:_cache.shouldInvalidCache,transform:_transform.transformForModule,moduleParsed(e){this.share.projectConfig.singleFileEmit&&_module_source_file.ModuleSourceFile.processSingleModuleSourceFile(this,e.id)},beforeBuildEnd:{order:"pre",handler(){this.share.projectConfig.singleFileEmit?(0,_ark_utils.writeDeclarationFiles)(this.share.arkProjectConfig.compileMode):(_ets_checker.compilerOptions.needDoArkTsLinter&&(0,_check_import_module.checkIfJsImportingArkts)(this),this.share.projectConfig.needCoverageInsert&&(this.share.ModuleSourceFile=_module_source_file.ModuleSourceFile.getSourceFiles()))}},buildEnd:_generate_module_abc.generateModuleAbc,generateBundle:_generate_bundle_abc.generateBundleAbc,cleanUp:function(){_newArrowCheck(this,e),_generate_sourcemap.SourceMapGenerator.cleanSourceMapObject(),(0,_ark_utils.cleanUpUtilsObjects)(),(0,_process_kit_import.cleanUpKitImportObjects)(),(0,_utils.cleanUpFilesList)(),(0,_generate_module_abc.cleanModuleMode)(),_module_source_file.ModuleSourceFile.cleanUpObjects(),(0,_check_shared_module.cleanSharedModuleSet)()}.bind(this)}}