"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.bindComponentAttr=bindComponentAttr,exports.createCollectElmtIdNode=createCollectElmtIdNode,exports.createComponentCreationStatement=createComponentCreationStatement,exports.createFunction=createFunction,exports.createViewStackProcessorStatement=createViewStackProcessorStatement,exports.getName=getName,exports.getRealNodePos=getRealNodePos,exports.ifRetakeId=ifRetakeId,exports.isAttributeNode=isAttributeNode,exports.isWrappedBuilder=isWrappedBuilder,exports.parentConditionalExpression=parentConditionalExpression,exports.parseGlobalBuilderParams=parseGlobalBuilderParams,exports.processComponentBlock=processComponentBlock,exports.processComponentBuild=processComponentBuild,exports.processComponentChild=processComponentChild,exports.processObjectPropertyBuilder=processObjectPropertyBuilder,exports.transferBuilderCall=transferBuilderCall,exports.validateStateStyleSyntax=validateStateStyleSyntax;var _typescript=_interopRequireDefault(require("typescript")),_path=_interopRequireDefault(require("path")),_pre_define=require("./pre_define"),_component_map=require("./component_map"),_validate_ui_syntax=require("./validate_ui_syntax"),_process_custom_component=require("./process_custom_component"),_utils=require("./utils"),_main=require("../main"),_process_ui_syntax=require("./process_ui_syntax"),_process_component_class=require("./process_component_class");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"==typeof e?e:String(e)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}function _newArrowCheck(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}function processComponentBuild(e,t){let r,i;return i=_main.partialUpdateConfig.partialUpdateMode?_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_INITIAL_RENDER_FUNCTION):_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_RENDER_FUNCTION),e.body&&e.body.statements&&e.body.statements.length&&validateRootNode(e,t)?(t=processComponentBlock(e.body,!1,t),r=_typescript.default.factory.updateMethodDeclaration(e,_typescript.default.getModifiers(e),e.asteriskToken,i,e.questionToken,e.typeParameters,e.parameters,e.type,t),_main.partialUpdateConfig.partialUpdateMode&&_utils.storedFileInfo.hasLocalBuilderInFile&&(t.statements.unshift((0,_process_component_class.contextStackPushOrPop)(_typescript.default.factory.createIdentifier(_pre_define.PUSH),[_typescript.default.factory.createThis()])),t.statements.push((0,_process_component_class.contextStackPushOrPop)(_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_POP_FUNCTION),[])))):r=_typescript.default.factory.updateMethodDeclaration(e,_typescript.default.getModifiers(e),e.asteriskToken,i,e.questionToken,e.typeParameters,e.parameters,e.type,e.body),r}function createLazyForEachBlockNode(e){return _typescript.default.factory.createIfStatement(_typescript.default.factory.createBinaryExpression(_typescript.default.factory.createBinaryExpression(_typescript.default.factory.createIdentifier(_pre_define.IS_INITIAL_ITEM),_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsEqualsEqualsToken),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_IF_UNDEFINED)),_typescript.default.factory.createToken(_typescript.default.SyntaxKind.BarBarToken),_typescript.default.factory.createIdentifier(_pre_define.IS_INITIAL_ITEM)),_typescript.default.factory.createBlock(e,!0),_typescript.default.factory.createBlock([_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createThis(),_typescript.default.factory.createIdentifier(_pre_define.UPDATE_LAZY_FOREACH_ELEMENTS)),void 0,[_typescript.default.factory.createIdentifier(_pre_define.IDS),_utils.storedFileInfo.lazyForEachInfo.forEachParameters.name]))],!0))}function parseGlobalBuilderParams(e,t){_main.partialUpdateConfig.partialUpdateMode&&e.length&&1===e.length&&_typescript.default.isIdentifier(e[0].name)&&(t.firstParam=e[0])}function processComponentBlock(e,t,r,i=!1,a=!1,n=void 0,s=void 0,o=!1,p=null,c=!1){var d=[];return processComponentChild(e,d,r,{isAcceleratePreview:!1,line:0,column:0,fileName:""},a,n,s,o,i,p),t&&!_main.partialUpdateConfig.partialUpdateMode&&d.unshift(createRenderingInProgress(!0)),i&&(_main.partialUpdateConfig.partialUpdateMode?d.unshift(createComponentCreationStatement(_typescript.default.factory.createExpressionStatement(createFunction(_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_TRANSITION_NAME),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_POP_FUNCTION),null)),[_typescript.default.factory.createExpressionStatement(createFunction(_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_TRANSITION_NAME),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CREATE_FUNCTION),null))],_pre_define.COMPONENT_TRANSITION_NAME,!1,i)):d.unshift(_typescript.default.factory.createExpressionStatement(createFunction(_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_TRANSITION_NAME),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CREATE_FUNCTION),null))),d.push(_typescript.default.factory.createExpressionStatement(createFunction(_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_TRANSITION_NAME),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_POP_FUNCTION),null)))),t&&!_main.partialUpdateConfig.partialUpdateMode&&d.push(createRenderingInProgress(!1)),c&&o&&p&&p.firstParam&&d.unshift(forkBuilderParamNode(p.firstParam)),t&&_main.projectConfig.optLazyForEach&&_utils.storedFileInfo.processLazyForEach&&_utils.storedFileInfo.lazyForEachInfo.forEachParameters?_typescript.default.factory.updateBlock(e,[createMyIdsNode(),createLazyForEachBlockNode(d),_typescript.default.factory.createReturnStatement(_typescript.default.factory.createIdentifier(_pre_define.MY_IDS))]):_typescript.default.factory.updateBlock(e,d)}function createMyIdsNode(){return _typescript.default.factory.createVariableStatement(void 0,_typescript.default.factory.createVariableDeclarationList([_typescript.default.factory.createVariableDeclaration(_typescript.default.factory.createIdentifier(_pre_define.MY_IDS),void 0,void 0,_typescript.default.factory.createArrayLiteralExpression([],!1))],_typescript.default.NodeFlags.Const))}function visitComponent(e){var r=this;_utils.storedFileInfo.lazyForEachInfo&&!_typescript.default.isBlock(e)&&_typescript.default.forEachChild(e,function(e){if(_newArrowCheck(this,r),!_utils.storedFileInfo.lazyForEachInfo.isDependItem){if(_typescript.default.isIdentifier(e)){var t=_main.globalProgram.checker.getSymbolAtLocation(e);if(t&&t.valueDeclaration===_utils.storedFileInfo.lazyForEachInfo.forEachParameters)return void(_utils.storedFileInfo.lazyForEachInfo.isDependItem=!0)}visitComponent(e)}}.bind(this))}function forkBuilderParamNode(e){e=e.name;return _typescript.default.factory.createVariableStatement(void 0,_typescript.default.factory.createVariableDeclarationList([_typescript.default.factory.createVariableDeclaration(_typescript.default.factory.createIdentifier(`__${e.escapedText.toString()}__`),void 0,void 0,e)],_typescript.default.NodeFlags.Const))}function validateRootNode(e,t){let r=!1;var i;return 1===e.body.statements.length?(i=e.body.statements[0],(_typescript.default.isIfStatement(i)||validateFirstNode(i))&&(r=!0)):r=!1,r||t.push({type:_utils.LogType.ERROR,message:"There should have a root container component.",pos:e.body.statements.pos}),r}function validateFirstNode(e){return!(_validate_ui_syntax.componentCollection.entryComponent===_validate_ui_syntax.componentCollection.currentClassName&&!validateContainerComponent(e))}function validateContainerComponent(e){if(_typescript.default.isExpressionStatement(e)&&e.expression&&(_typescript.default.isEtsComponentExpression(e.expression)||_typescript.default.isCallExpression(e.expression))){var t={name:null,node:null,arguments:[]};if(validateEtsComponentNode(e.expression,t),t.name&&checkContainer(t.name,t.node))return!0}return!1}let newsupplement={isAcceleratePreview:!1,line:0,column:0,fileName:""};function validateEtsComponentNode(e,t){let r=e;for(t.name=null;_typescript.default.isCallExpression(r)&&r.expression&&_typescript.default.isPropertyAccessExpression(r.expression)&&r.expression.expression;)r=r.expression.expression;return!!_typescript.default.isEtsComponentExpression(r)&&(_typescript.default.isIdentifier(r.expression)&&(t.name=r.expression.getText(),t.node=r,t.arguments=r.arguments||[]),!0)}let sourceNode;function processComponentChild(e,a,n,t={isAcceleratePreview:!1,line:0,column:0,fileName:""},s=!1,o=void 0,p=void 0,c=!1,d=!1,f=null){var r,l=this;if(t.isAcceleratePreview&&(newsupplement=t,r=_typescript.default.readConfigFile(_path.default.resolve(__dirname,"../tsconfig.json"),_typescript.default.sys.readFile).config.compilerOptions,Object.assign(r,{sourceMap:!1}),sourceNode=_typescript.default.createSourceFile("",e.getText(),_typescript.default.ScriptTarget.Latest,!0,_typescript.default.ScriptKind.ETS,r)),e.statements.length){const _=o;e.statements.forEach(function(e){if(_newArrowCheck(this,l),_typescript.default.isExpressionStatement(e)){assignParameter(p,e),checkEtsComponent(e,n);var t=getName(e);switch(_pre_define.CARD_ENABLE_COMPONENTS.has(t)&&(0,_process_ui_syntax.validatorCard)(n,_pre_define.CARD_LOG_TYPE_COMPONENTS,e.getStart(),t),getComponentType(e,n,t,o,p)){case ComponentType.innerComponent:var[r,i]=checkEtsAndIdInIf(e,_);_typescript.default.isIdentifier(r.expression)&&(o=r.expression.escapedText.toString()),processInnerComponent(e,a,n,o,s,c,d,i,_,f);break;case ComponentType.customComponent:r=checkIdInIf(e,_);o=void 0,newsupplement.isAcceleratePreview||(e.expression&&_typescript.default.isEtsComponentExpression(e.expression)&&e.expression.body&&(i=processExpressionStatementChange(e,e.expression.body,n))&&(e=i),(0,_process_custom_component.processCustomComponent)(e,a,n,t,s,c,r,f));break;case ComponentType.forEachComponent:o=void 0,_main.partialUpdateConfig.partialUpdateMode?processForEachComponentNew(e,a,n,t,c,f):processForEachComponent(e,a,n,s,c);break;case ComponentType.repeatComponent:o=void 0,processRepeatComponent(e,a,n,s,c,d,f);break;case ComponentType.customBuilderMethod:o=void 0,_main.partialUpdateConfig.partialUpdateMode?a.push(transferBuilderCall(e,t,s)):a.push(addInnerBuilderParameter(e,c));break;case ComponentType.builderParamMethod:case ComponentType.builderTypeFunction:o=void 0,_main.partialUpdateConfig.partialUpdateMode?a.push(transferBuilderCall(e,t,s)):a.push(addInnerBuilderParameter(e));break;case ComponentType.function:o=void 0,a.push(e)}}else _typescript.default.isIfStatement(e)?(assignParameter(p,e),processIfStatement(e,a,n,s,c,f)):_typescript.default.isBlock(e)||n.push({type:_utils.LogType.ERROR,message:"Only UI component syntax can be written in build method.",pos:e.getStart()});_utils.storedFileInfo.lazyForEachInfo.isDependItem=!1}.bind(this))}t.isAcceleratePreview&&(newsupplement={isAcceleratePreview:!1,line:0,column:0,fileName:""})}function assignParameter(e,t){_main.partialUpdateConfig.partialUpdateMode&&_main.projectConfig.optLazyForEach&&_utils.storedFileInfo.processLazyForEach&&(e&&e[0]&&(_utils.storedFileInfo.lazyForEachInfo.forEachParameters=e[0]),_utils.storedFileInfo.lazyForEachInfo.forEachParameters)&&visitComponent(t)}function transferBuilderCall(e,t,r=!1){var i;if(e.expression&&_typescript.default.isCallExpression(e.expression))return(i=builderCallNode(e.expression)).expression.questionDotToken=e.expression.questionDotToken,e.expression.arguments&&1===e.expression.arguments.length&&_typescript.default.isObjectLiteralExpression(e.expression.arguments[0])?_typescript.default.factory.createExpressionStatement(_typescript.default.factory.updateCallExpression(e.expression,i,void 0,[_typescript.default.factory.createCallExpression(_typescript.default.factory.createIdentifier(_pre_define.BUILDER_PARAM_PROXY),void 0,[_typescript.default.factory.createStringLiteral(t),traverseBuilderParams(e.expression.arguments[0],r)])])):_typescript.default.factory.createExpressionStatement(_typescript.default.factory.updateCallExpression(e.expression,i,void 0,_main.projectConfig.optLazyForEach&&(_utils.storedFileInfo.processLazyForEach&&_utils.storedFileInfo.lazyForEachInfo.forEachParameters||r)?[...e.expression.arguments,_typescript.default.factory.createNull(),_typescript.default.factory.createIdentifier(_pre_define.MY_IDS)]:e.expression.arguments))}function builderCallNode(e){let t;return t=e.expression&&_typescript.default.isPropertyAccessExpression(e.expression)&&e.expression.questionDotToken&&e.expression.questionDotToken.kind===_typescript.default.SyntaxKind.QuestionDotToken?_typescript.default.factory.createCallChain(_typescript.default.factory.createPropertyAccessChain(e.expression,e.questionDotToken,_typescript.default.factory.createIdentifier(_pre_define.BUILDER_ATTR_BIND)),void 0,void 0,[_typescript.default.factory.createThis()]):_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(e.expression,_typescript.default.factory.createIdentifier(_pre_define.BUILDER_ATTR_BIND)),void 0,[_typescript.default.factory.createThis()])}function traverseBuilderParams(e,i){var a=this;const n=[];return e.properties&&e.properties.length&&e.properties.forEach(function(e){var t,r;_newArrowCheck(this,a),_typescript.default.isPropertyAssignment(e)&&e.initializer&&_typescript.default.isPropertyAccessExpression(e.initializer)&&e.initializer.expression&&e.initializer.name&&_typescript.default.isIdentifier(e.initializer.name)&&(t=e.initializer.name.escapedText.toString(),!_utils.storedFileInfo.processGlobalBuilder&&e.initializer.expression.kind===_typescript.default.SyntaxKind.ThisKeyword||i&&_typescript.default.isIdentifier(e.initializer.expression)&&e.initializer.expression.escapedText.toString()===_pre_define.$$)?(r=e.initializer.expression.kind===_typescript.default.SyntaxKind.ThisKeyword,addProperties(n,e,t,i,r)):addBuilderParamsProperties(n,e)}.bind(this)),_typescript.default.factory.createObjectLiteralExpression(n)}function addBuilderParamsProperties(e,t){var r=_typescript.default.isShorthandPropertyAssignment(t)?t.name:t.initializer;e.push(_typescript.default.factory.createPropertyAssignment(t.name,_typescript.default.factory.createArrowFunction(void 0,void 0,[],void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),r)))}function addProperties(e,t,r,i,a){e.push(_typescript.default.factory.createPropertyAssignment(t.name,_typescript.default.factory.createArrowFunction(void 0,void 0,[],void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createParenthesizedExpression(_typescript.default.factory.createConditionalExpression(_typescript.default.factory.createElementAccessExpression(i&&!a?_typescript.default.factory.createIdentifier(_pre_define.$$):_typescript.default.factory.createThis(),_typescript.default.factory.createStringLiteral("__"+r)),_typescript.default.factory.createToken(_typescript.default.SyntaxKind.QuestionToken),_typescript.default.factory.createElementAccessExpression(i&&!a?_typescript.default.factory.createIdentifier(_pre_define.$$):_typescript.default.factory.createThis(),_typescript.default.factory.createStringLiteral("__"+r)),_typescript.default.factory.createToken(_typescript.default.SyntaxKind.ColonToken),_typescript.default.factory.createElementAccessExpression(i&&!a?_typescript.default.factory.createIdentifier(_pre_define.$$):_typescript.default.factory.createThis(),_typescript.default.factory.createStringLiteral(r)))))))}function addInnerBuilderParameter(e,t=!1){return e.expression&&_typescript.default.isCallExpression(e.expression)&&e.expression.arguments?(e.expression.arguments.push(t?parentConditionalExpression():_typescript.default.factory.createThis()),_typescript.default.factory.createExpressionStatement(_typescript.default.factory.updateCallExpression(e.expression,e.expression.expression,e.expression.typeArguments,e.expression.arguments))):e}function processExpressionStatementChange(e,t,r){let i;return e.expression.expression&&_typescript.default.isIdentifier(e.expression.expression)?i=e.expression.expression.escapedText.toString():e.expression.expression&&_typescript.default.isPropertyAccessExpression(e.expression.expression)&&(i=e.expression.expression.getText()),_validate_ui_syntax.builderParamObjectCollection.get(i)&&1===_validate_ui_syntax.builderParamObjectCollection.get(i).size?processBlockToExpression(e,t,r,i,!1):"esmodule"===_main.projectConfig.compileMode&&"rollup"===process.env.compileTool&&_utils.storedFileInfo.overallBuilderParamCollection.get(i)&&1===_utils.storedFileInfo.overallBuilderParamCollection.get(i).size?processBlockToExpression(e,t,r,i,!0):(r.push({type:_utils.LogType.ERROR,message:`In the trailing lambda case, '${i}' must have one and only one property decorated with `+"@BuilderParam, and its @BuilderParam expects no parameter.",pos:e.getStart()}),null)}function processBlockToExpression(e,t,r,i,a){a=(a?[..._utils.storedFileInfo.overallBuilderParamCollection.get(i)]:[..._validate_ui_syntax.builderParamObjectCollection.get(i)]).slice(-1)[0],i=processComponentBlock(t,!1,r),t=_typescript.default.factory.createArrowFunction(void 0,void 0,[],void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),i),r=_typescript.default.factory.createPropertyAssignment(_typescript.default.factory.createIdentifier(a),t);let n=e.expression.arguments;n&&!n.length?n=[_typescript.default.factory.createObjectLiteralExpression([r],!0)]:_typescript.default.isObjectLiteralExpression(n[0])&&1===n.length?n=[_typescript.default.factory.createObjectLiteralExpression(e.expression.arguments[0].properties.concat([r]),!0)]:_typescript.default.isObjectLiteralExpression(n[0])&&2===n.length&&(n=[_typescript.default.factory.createObjectLiteralExpression(e.expression.arguments[0].properties.concat([r]),!0),n[1]]);i=_typescript.default.factory.updateCallExpression(e.expression,e.expression.expression,e.expression.expression.typeArguments,n);return(e.expression.expression.parent=i).parent=e.expression.parent,e=_typescript.default.factory.updateExpressionStatement(e,i)}function parseEtsComponentExpression(e){let t,r=!1,i=e.expression;for(;i;){if(_typescript.default.isCallExpression(i)&&i.expression&&_typescript.default.isPropertyAccessExpression(i.expression)&&(r=!0),_typescript.default.isEtsComponentExpression(i)){t=i;break}i=i.expression}return{etsComponentNode:t,hasAttr:r}}function createCollectElmtIdNode(){return _typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createIdentifier(_pre_define.MY_IDS),_typescript.default.factory.createIdentifier(_pre_define.PUSH)),void 0,[_typescript.default.factory.createIdentifier(_pre_define.ELMTID)]))}function processInnerComponent(e,t,r,i=void 0,a=!1,n=!1,s=!1,o=void 0,p=void 0,c=null){var d=createComponent(e,_pre_define.COMPONENT_CREATE_FUNCTION),d=([].push(d.newNode),{name:null,arguments:[]});validateEtsComponentNode(e.expression,d),p&&d.name&&checkNonspecificParents(e,d.name,p,r),_main.partialUpdateConfig.partialUpdateMode&&_pre_define.ItemComponents.includes(d.name)?processItemComponent(e,d,t,r,i,n,o,c):_main.partialUpdateConfig.partialUpdateMode&&_pre_define.TabContentAndNavDestination.has(d.name)?processTabAndNav(e,t,d,r,i,n,o,c):processNormalComponent(e,d,t,r,i,a,n,s,o,c)}function processNormalComponent(e,t,r,i,a=void 0,n=!1,s=!1,o=!1,p=void 0,c=null){var d=[],f=(addElmtIdNode()&&d.push(createCollectElmtIdNode()),[]),l=createComponent(e,_pre_define.COMPONENT_CREATE_FUNCTION),t=(d.push(l.newNode),processDebug(e,t,d),parseEtsComponentExpression(e)),_=l.identifierNode.getText();let u;_main.partialUpdateConfig.partialUpdateMode&&p&&(u=r.length),t.etsComponentNode.body&&_typescript.default.isBlock(t.etsComponentNode.body)?(l.isButton&&(checkButtonParamHasLabel(t.etsComponentNode,i),_main.projectConfig.isPreview||_main.projectConfig.enableDebugLine?d.splice(-2,1,createComponent(e,_pre_define.COMPONENT_CREATE_CHILD_FUNCTION).newNode):d.splice(-1,1,createComponent(e,_pre_define.COMPONENT_CREATE_CHILD_FUNCTION).newNode)),t.hasAttr&&bindComponentAttr(e,l.identifierNode,d,i,!0,!1,f),processInnerCompStatements(r,d,e,s,o,void 0,f,_,c),_utils.storedFileInfo.lazyForEachInfo.isDependItem=!1,processComponentChild(t.etsComponentNode.body,r,i,{isAcceleratePreview:!1,line:0,column:0,fileName:""},n,a,void 0,s,!1,c)):(bindComponentAttr(e,l.identifierNode,d,i,!0,!1,f),processInnerCompStatements(r,d,e,s,o,void 0,f,_,c)),(l.isContainerComponent||l.needPop)&&r.push(createComponent(e,_pre_define.COMPONENT_POP_FUNCTION).newNode),_main.partialUpdateConfig.partialUpdateMode&&p&&r.splice(u,r.length-u,ifRetakeId(r.slice(u),p))}function ifRetakeId(e,t){return _typescript.default.factory.createIfStatement(_typescript.default.factory.createPrefixUnaryExpression(_typescript.default.SyntaxKind.ExclamationToken,_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_IF),_typescript.default.factory.createIdentifier(_pre_define.CAN_RETAKE)),void 0,[t])),_typescript.default.factory.createBlock(e,!0),void 0)}function processRepeatComponent(e,t,r,i=!1,a=!1,n=!1,s=null){r=recurseRepeatExpression(e.expression,r,i,a,n);t.push(createComponentCreationStatement(e,[_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(r,_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_RENDER_FUNCTION)),void 0,[_typescript.default.factory.createIdentifier(_pre_define.ISINITIALRENDER)]))],_pre_define.COMPONENT_REPEAT,a,n,void 0,null,s))}function recurseRepeatExpression(e,t,r=!1,i=!1,a=!1){var n;return _typescript.default.isCallExpression(e)&&e.expression&&_typescript.default.isIdentifier(e.expression)&&e.expression.getText()===_pre_define.COMPONENT_REPEAT?_typescript.default.factory.createCallExpression(e.expression,e.typeArguments,[...e.arguments,_typescript.default.factory.createThis()]):_typescript.default.isPropertyAccessExpression(e)?_typescript.default.factory.updatePropertyAccessExpression(e,recurseRepeatExpression(e.expression,t,r,i,a),e.name):(n=processRepeatAttributeArrowNode(e.arguments),_utils.storedFileInfo.processRepeat=!0,n=processRepeatPropWithChild(e,n,t,r,i,a),_utils.storedFileInfo.processRepeat=!1,_typescript.default.factory.updateCallExpression(e,recurseRepeatExpression(e.expression,t,r,i,a),void 0,n))}function processRepeatPropWithChild(e,t,r,i=!1,a=!1,n=!1){return _typescript.default.isPropertyAccessExpression(e.expression)&&_typescript.default.isIdentifier(e.expression.name)&&e.expression.name.getText()===_pre_define.REPEAT_EACH&&0<t.length&&t[0].body?[_typescript.default.factory.updateArrowFunction(t[0],t[0].modifiers,t[0].typeParameters,t[0].parameters,t[0].type,t[0].equalsGreaterThanToken,processComponentBlock(processRepeatCallBackBlock(t[0]),!1,r,n,i,void 0,void 0,a)),...t.slice(1)]:_typescript.default.isPropertyAccessExpression(e.expression)&&_typescript.default.isIdentifier(e.expression.name)&&e.expression.name.getText()===_pre_define.REPEAT_TEMPLATE&&1<t.length&&t[1].body?[t[0],_typescript.default.factory.updateArrowFunction(t[1],t[1].modifiers,t[1].typeParameters,t[1].parameters,t[1].type,t[1].equalsGreaterThanToken,processComponentBlock(processRepeatCallBackBlock(t[1]),!1,r,n,i,void 0,void 0,a)),...t.slice(2)]:t}function processRepeatCallBackBlock(e){return(_typescript.default.isBlock(e.body)?e:_typescript.default.factory.updateArrowFunction(e,_typescript.default.getModifiers(e),e.typeParameters,e.parameters,e.type,e.equalsGreaterThanToken,_typescript.default.factory.createBlock([_typescript.default.factory.createExpressionStatement(e.body)],!0))).body}function processRepeatAttributeArrowNode(t){for(let e=0;e<t.length;e++)for(;_typescript.default.isParenthesizedExpression(t[e]);){if(_typescript.default.isArrowFunction(t[e].expression)){t.splice(e,1,t[e].expression);break}if(!t[e].expression)break;t[e]=t[e].expression}return t}function processDebug(n,s,o,p=!1){if((_main.projectConfig.isPreview||_main.projectConfig.enableDebugLine)&&s.name&&!_component_map.NO_DEBUG_LINE_COMPONENT.has(s.name)){let e,t,r=1,i=1;sourceNode&&newsupplement.isAcceleratePreview?(e=sourceNode.getLineAndCharacterOfPosition(getRealNodePos(n)-22),t=newsupplement.fileName,0===e.line&&(i=newsupplement.column-1),r=newsupplement.line):(e=_process_ui_syntax.transformLog.sourceFile.getLineAndCharacterOfPosition(getRealNodePos(n)),t=_process_ui_syntax.transformLog.sourceFile.fileName.replace(/\.ts$/,""));let a;_main.projectConfig.isPreview?a=11<=_main.projectConfig.minAPIVersion?""+_path.default.relative(_main.projectConfig.projectRootPath,t).replace(/\\+/g,"/")+`(${e.line+r}:${e.character+i})`:""+_path.default.relative(_main.projectConfig.projectPath,t).replace(/\\+/g,"/")+`(${e.line+r}:${e.character+i})`:_main.projectConfig.enableDebugLine&&(a=""+_path.default.relative(_main.projectConfig.projectRootPath,t)+`(${e.line+r}:${e.character+i})`);n=_typescript.default.factory.createExpressionStatement(createFunction(_typescript.default.factory.createIdentifier(s.name),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_DEBUGLINE_FUNCTION),createDebugLineArgs(a)));if(p)return n;o.push(n)}}function createDebugLineArgs(e){var e=[_typescript.default.factory.createStringLiteral(e)],t=_utils.storedFileInfo.getCurrentArkTsFile().pkgName;return t&&e.push(_typescript.default.factory.createStringLiteral(t)),_typescript.default.factory.createNodeArray(e)}function processInnerCompStatements(e,t,r,i,a,n,s,o,p){_main.partialUpdateConfig.partialUpdateMode?e.push(createComponentCreationStatement(r,t,o,i,a,n,s,p)):e.push(...t)}function createComponentCreationArrowParams(e,t,r=!1){var i=[_typescript.default.factory.createParameterDeclaration(void 0,void 0,_typescript.default.factory.createIdentifier(_pre_define.ELMTID),void 0,void 0,void 0),_typescript.default.factory.createParameterDeclaration(void 0,void 0,_typescript.default.factory.createIdentifier(_pre_define.ISINITIALRENDER),void 0,void 0,void 0)];return!r&&_main.partialUpdateConfig.optimizeComponent&&e&&t&&t.firstParam&&(r=t.firstParam.name,i.push(_typescript.default.factory.createParameterDeclaration(void 0,void 0,r,void 0,void 0,_typescript.default.factory.createIdentifier(`__${r.escapedText.toString()}__`)))),i}function createComponentCreationStatement(e,t,r,i=!1,a=!1,n=void 0,s=null,o=null,p=!1){var c=[...t],n=(n&&c.push(processDebug(e,n,t,!0)),a||createInitRenderStatement(e,s,c),_main.partialUpdateConfig.optimizeComponent||(c.unshift(createViewStackProcessorStatement(_pre_define.STARTGETACCESSRECORDINGFOR,_pre_define.ELMTID)),c.push(createViewStackProcessorStatement(_pre_define.STOPGETACCESSRECORDING))),[_typescript.default.factory.createArrowFunction(void 0,void 0,createComponentCreationArrowParams(i,o,p),void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createBlock(c,!0))]);return _main.partialUpdateConfig.optimizeComponent&&n.push(a?_typescript.default.factory.createNull():_typescript.default.factory.createIdentifier(r)),_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression((0,_process_custom_component.createConditionParent)(i),_typescript.default.factory.createIdentifier(_main.partialUpdateConfig.optimizeComponent?_pre_define.OBSERVECOMPONENTCREATION2:_pre_define.OBSERVECOMPONENTCREATION)),void 0,n))}function createViewStackProcessorStatement(e,t){return _typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createIdentifier(_pre_define.VIEWSTACKPROCESSOR),_typescript.default.factory.createIdentifier(e)),void 0,t?[_typescript.default.factory.createIdentifier(_pre_define.ELMTID)]:[]))}function createInitRenderStatement(e,t,r){_main.partialUpdateConfig.optimizeComponent?t&&t.length&&r.push(_typescript.default.factory.createIfStatement(_typescript.default.factory.createIdentifier(_pre_define.ISINITIALRENDER),_typescript.default.factory.createBlock(t,!0))):r.push(_typescript.default.factory.createIfStatement(_typescript.default.factory.createPrefixUnaryExpression(_typescript.default.SyntaxKind.ExclamationToken,_typescript.default.factory.createIdentifier(_pre_define.ISINITIALRENDER)),_typescript.default.factory.createBlock([_typescript.default.isExpressionStatement(e)?createComponent(e,_pre_define.COMPONENT_POP_FUNCTION).newNode:createIfPop()],!0),t&&t.length?_typescript.default.factory.createBlock(t,!0):void 0))}function processItemComponent(e,t,r,i,a=void 0,n=!1,s=void 0,o=null){var p=[],c=[],d=[],f=(addElmtIdNode()&&p.push(createCollectElmtIdNode()),createComponent(e,_pre_define.COMPONENT_CREATE_FUNCTION)),l=checkLazyCreate(e,t),_=createItemCreate(t,l),_=(p.push(_),parseEtsComponentExpression(e));_.etsComponentNode.body&&_typescript.default.isBlock(_.etsComponentNode.body)?(_.hasAttr&&bindComponentAttr(e,f.identifierNode,p,i,!0,!1,c),_utils.storedFileInfo.lazyForEachInfo.isDependItem=!1,processComponentChild(_.etsComponentNode.body,d,i,{isAcceleratePreview:!1,line:0,column:0,fileName:""},!1,a,void 0,n,!1,o)):bindComponentAttr(e,f.identifierNode,p,i,!0,!1,c);let u;u=s?ifRetakeId([createItemBlock(e,p,d,t,l,c,n,o)],s):createItemBlock(e,p,d,t,l,c,n,o),r.push(u)}function createItemCreate(e,t){var r=[];return t?r.push(_typescript.default.factory.createIdentifier(_pre_define.DEEPRENDERFUNCTION),_typescript.default.factory.createTrue()):r.push(_typescript.default.factory.createArrowFunction(void 0,void 0,[],void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createBlock([],!1)),_typescript.default.factory.createFalse()),r.push(...e.arguments),_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createIdentifier(e.name),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CREATE_FUNCTION)),void 0,r))}function getItemCreation(e){var t=[];let r=_pre_define.OBSERVECOMPONENTCREATION;return _main.partialUpdateConfig.optimizeComponent?(t.push(_typescript.default.factory.createIdentifier(_pre_define.ITEMCREATION2),_typescript.default.factory.createIdentifier(e.name)),r=_pre_define.OBSERVECOMPONENTCREATION2):t.push(_typescript.default.factory.createIdentifier(_pre_define.ITEMCREATION)),{creationArgs:t,creationName:r}}function createItemBlock(e,t,r,i,a,n,s,o){t=[createItemCreation2(e,t,i,n,s,o)],n=getItemCreation(i);return a?(t.unshift(createItemCreation(e,s,o)),t.push(createDeepRenderFunction(e,r,s,o),_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createThis(),_typescript.default.factory.createIdentifier(n.creationName)),void 0,n.creationArgs)),createComponent(e,_pre_define.COMPONENT_POP_FUNCTION).newNode)):(_main.partialUpdateConfig.optimizeComponent||t.unshift(createItemCreation(e,s,o)),t.push(createObservedDeepRender(e,r,n),_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createIdentifier(_pre_define.OBSERVEDDEEPRENDER),void 0,[])))),_typescript.default.factory.createBlock(t,!0)}function checkLazyCreate(e,t){return t.name===_pre_define.LIST_ITEM&&!(t.arguments.length&&_typescript.default.isStringLiteral(t.arguments[0])&&"false"===t.arguments[0].text||_utils.storedFileInfo.processRepeat||isLazyForEachChild(e))}function createItemCreation(e,t,r){return _typescript.default.factory.createVariableStatement(void 0,_typescript.default.factory.createVariableDeclarationList([_typescript.default.factory.createVariableDeclaration(_typescript.default.factory.createIdentifier(_pre_define.ITEMCREATION),void 0,void 0,_typescript.default.factory.createArrowFunction(void 0,void 0,createComponentCreationArrowParams(t,r),void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createBlock([createViewStackProcessorStatement(_pre_define.STARTGETACCESSRECORDINGFOR,_pre_define.ELMTID),_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createIdentifier(_pre_define.ITEMCREATION2),void 0,createItemCreationArgs(t,r))),_typescript.default.factory.createIfStatement(_typescript.default.factory.createPrefixUnaryExpression(_typescript.default.SyntaxKind.ExclamationToken,_typescript.default.factory.createIdentifier(_pre_define.ISINITIALRENDER)),_typescript.default.factory.createBlock([createComponent(e,_pre_define.COMPONENT_POP_FUNCTION).newNode],!0)),createViewStackProcessorStatement(_pre_define.STOPGETACCESSRECORDING)],!0)))],_typescript.default.NodeFlags.Const))}function createItemCreation2(e,t,r,i,a,n){e=[...t,processDebug(e,r,t,!0)];return i&&i.length&&e.push(_typescript.default.factory.createIfStatement(_typescript.default.factory.createIdentifier(_pre_define.ISINITIALRENDER),_typescript.default.factory.createBlock(i,!0))),_typescript.default.factory.createVariableStatement(void 0,_typescript.default.factory.createVariableDeclarationList([_typescript.default.factory.createVariableDeclaration(_typescript.default.factory.createIdentifier(_pre_define.ITEMCREATION2),void 0,void 0,_typescript.default.factory.createArrowFunction(void 0,void 0,createComponentCreationArrowParams(a,n),void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createBlock(e,!0)))],_typescript.default.NodeFlags.Const))}function createItemCreationArgs(e,t){var r=[_typescript.default.factory.createIdentifier(_pre_define.ELMTID),_typescript.default.factory.createIdentifier(_pre_define.ISINITIALRENDER)];return _main.partialUpdateConfig.optimizeComponent&&e&&t&&t.firstParam&&r.push(t.firstParam.name),r}function createDeepRenderFunction(e,t,r,i){t=[_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createIdentifier(_pre_define.ITEMCREATION),void 0,createItemCreationArgs(r,i))),_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createThis(),_typescript.default.factory.createIdentifier(_pre_define.UPDATE_FUNC_BY_ELMT_ID)),_typescript.default.factory.createIdentifier(_pre_define.CREATE_SET_METHOD)),void 0,[_typescript.default.factory.createIdentifier(_pre_define.ELMTID),_typescript.default.factory.createIdentifier(_pre_define.ITEMCREATION)])),...t,createComponent(e,_pre_define.COMPONENT_POP_FUNCTION).newNode];return _main.partialUpdateConfig.optimizeComponent&&t.splice(1,1),_typescript.default.factory.createVariableStatement(void 0,_typescript.default.factory.createVariableDeclarationList([_typescript.default.factory.createVariableDeclaration(_typescript.default.factory.createIdentifier(_pre_define.DEEPRENDERFUNCTION),void 0,void 0,_typescript.default.factory.createArrowFunction(void 0,void 0,createComponentCreationArrowParams(r,i),void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createBlock(t,!0)))],_typescript.default.NodeFlags.Const))}function createObservedDeepRender(e,t,r){return _typescript.default.factory.createVariableStatement(void 0,_typescript.default.factory.createVariableDeclarationList([_typescript.default.factory.createVariableDeclaration(_typescript.default.factory.createIdentifier(_pre_define.OBSERVEDDEEPRENDER),void 0,void 0,_typescript.default.factory.createArrowFunction(void 0,void 0,[],void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createBlock([_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createThis(),_typescript.default.factory.createIdentifier(r.creationName)),void 0,r.creationArgs)),...t,createComponent(e,_pre_define.COMPONENT_POP_FUNCTION).newNode],!0)))],_typescript.default.NodeFlags.Const))}function processTabAndNav(e,t,r,i,a=void 0,n=!1,s=void 0,o=null){var p=r.name,c=getEtsComponentExpression(e).body;let d;var f=_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createIdentifier(p),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_POP_FUNCTION)),void 0,[])),l=[],_=(addElmtIdNode()&&l.push(createCollectElmtIdNode()),[]);let u;s&&(u=t.length),c&&c.statements.length?(processComponentChild(c,c=[],i,{isAcceleratePreview:!1,line:0,column:0,fileName:""},!1,a,void 0,n,!1,o),a=[_typescript.default.factory.createArrowFunction(void 0,void 0,[],void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createBlock([...c],!0))],p===_pre_define.NAV_DESTINATION&&a.push(...navigationCreateParam(_pre_define.NAV_DESTINATION,_pre_define.COMPONENT_CREATE_FUNCTION,void 0,!0)),d=_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createIdentifier(p),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CREATE_FUNCTION)),void 0,a)),bindComponentAttr(e,_typescript.default.factory.createIdentifier(p),l,i,!0,!1,_),processInnerCompStatements(t,[d,...l],e,n,!1,r,_,p,o),_utils.storedFileInfo.lazyForEachInfo.isDependItem=!1):(d=_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createIdentifier(p),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CREATE_FUNCTION)),void 0,p===_pre_define.NAV_DESTINATION?navigationCreateParam(_pre_define.NAV_DESTINATION,_pre_define.COMPONENT_CREATE_FUNCTION):[])),bindComponentAttr(e,_typescript.default.factory.createIdentifier(p),l,i,!0,!1,_),processInnerCompStatements(t,[d,...l],e,n,!1,r,_,p,o)),t.push(f),s&&t.splice(u,t.length-u,ifRetakeId(t.slice(u),s))}function getRealNodePos(e){return-1===e.pos&&e.expression?getRealNodePos(e.expression):e.getStart()}function processForEachComponent(t,e,r,i=!1,a=!1){var n=_typescript.default.factory.createExpressionStatement(createFunction(t.expression.expression,_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_POP_FUNCTION),null));if(_typescript.default.isCallExpression(t.expression)){var s=_typescript.default.factory.createPropertyAccessExpression(t.expression.expression,_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CREATE_FUNCTION)),o=Array.from(t.expression.arguments);let e;o.length&&(e=_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createIdentifier(_pre_define.FOREACH_OBSERVED_OBJECT),_typescript.default.factory.createIdentifier(_pre_define.FOREACH_GET_RAW_OBJECT)),void 0,[o[0]])),o.splice(0,1,e);var p=processForEachFunctionBlock(t.expression),r=processForEachBlock(t.expression,r,p,i);r&&o.splice(1,1,r),t=addForEachId(_typescript.default.factory.updateExpressionStatement(t,_typescript.default.factory.updateCallExpression(t.expression,s,t.expression.typeArguments,o)),a)}e.push(t,n)}function collectForEachAttribute(e,t,r){let i=e.expression;for(;i&&_typescript.default.isCallExpression(i);){if(i.expression&&_typescript.default.isPropertyAccessExpression(i.expression))t.unshift(generateForEachAttribute(i,r));else if(i.expression&&_typescript.default.isIdentifier(i.expression))return _typescript.default.factory.updateExpressionStatement(e,i);i=i.expression?.expression}return e}function generateForEachAttribute(e,t){return _typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createIdentifier(t),e.expression.name),void 0,e.arguments))}function processForEachComponentNew(e,t,r,i,a=!1,n=null){var s,o,p,c,d,f=[],e=collectForEachAttribute(e,f,i),i=[],l=_typescript.default.factory.createExpressionStatement(createFunction(e.expression.expression,_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_POP_FUNCTION),null));_typescript.default.isCallExpression(e.expression)&&(checkForEachComponent(e)?_utils.storedFileInfo.processForEach+=1:_utils.storedFileInfo.processLazyForEach+=1,s=Array.from(e.expression.arguments),o=_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(e.expression.expression,_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CREATE_FUNCTION)),void 0,[])),c=processForEachFunctionBlock(e.expression),r=processForEachBlock(e.expression,r,c,!1,a,n),r=createItemGenFunctionStatement(e.expression,r,c),p=createItemIdFuncStatement(e.expression,s),c=createUpdateFunctionStatement(s,c,a),d=createLazyForEachStatement(s),e.expression.expression.getText()===_pre_define.COMPONENT_FOREACH?(i.push(o,...f,r,c),t.push(createComponentCreationStatement(e,i,_pre_define.COMPONENT_FOREACH,a,!1,void 0,null,n),l)):s[2]?t.push(_typescript.default.factory.createBlock([r,p,d,...f,l],!0)):t.push(_typescript.default.factory.createBlock([r,d,l,...f],!0)),checkForEachComponent(e)?--_utils.storedFileInfo.processForEach:--_utils.storedFileInfo.processLazyForEach)}function checkForEachComponent(e){return e.expression.expression&&_typescript.default.isIdentifier(e.expression.expression)&&e.expression.expression.getText()===_pre_define.COMPONENT_FOREACH}function createItemGenFunctionStatement(e,t,r){if(r&&_typescript.default.isArrowFunction(r))return _typescript.default.factory.createVariableStatement(void 0,_typescript.default.factory.createVariableDeclarationList([_typescript.default.factory.createVariableDeclaration(_typescript.default.factory.createIdentifier(e.expression.getText()===_pre_define.COMPONENT_FOREACH?_pre_define.FOREACHITEMGENFUNCTION:_pre_define.__LAZYFOREACHITEMGENFUNCTION),void 0,void 0,_typescript.default.factory.createArrowFunction(void 0,void 0,r.parameters&&1<=r.parameters.length?getParameters(r):[],void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createBlock(r.parameters&&1<=r.parameters.length?isForEachItemGeneratorParam(r,t):t?[...t]:void 0,!0)))],_typescript.default.NodeFlags.Const))}function isForEachItemGeneratorParam(e,t){var r=[];return r.push(_typescript.default.factory.createVariableStatement(void 0,_typescript.default.factory.createVariableDeclarationList([_typescript.default.factory.createVariableDeclaration(_typescript.default.factory.createIdentifier(e.parameters[0]&&e.parameters[0].name.getText()),void 0,void 0,_typescript.default.factory.createIdentifier(_pre_define._ITEM))],_typescript.default.NodeFlags.Const))),t&&r.push(...t),r}function getParameters(e){var t=[_typescript.default.factory.createParameterDeclaration(void 0,void 0,_typescript.default.factory.createIdentifier(_pre_define._ITEM))];return e.parameters&&1<e.parameters.length&&t.push(e.parameters[1]),_main.projectConfig.optLazyForEach&&_utils.storedFileInfo.processLazyForEach&&(1===e.parameters.length&&t.push(_typescript.default.factory.createParameterDeclaration(void 0,void 0,_typescript.default.factory.createIdentifier(_pre_define.INDEX))),t.push(_typescript.default.factory.createParameterDeclaration(void 0,void 0,_typescript.default.factory.createIdentifier(_pre_define.IS_INITIAL_ITEM)),_typescript.default.factory.createParameterDeclaration(void 0,void 0,_typescript.default.factory.createIdentifier(_pre_define.IDS)))),t}function createItemIdFuncStatement(e,t){if(t[2])return _typescript.default.factory.createVariableStatement(void 0,_typescript.default.factory.createVariableDeclarationList([_typescript.default.factory.createVariableDeclaration(_typescript.default.factory.createIdentifier(e.expression.getText()===_pre_define.COMPONENT_FOREACH?_pre_define.FOREACHITEMIDFUNC:_pre_define.__LAZYFOREACHITEMIDFUNC),void 0,void 0,t[2])],_typescript.default.NodeFlags.Const))}function createUpdateFunctionStatement(e,t,r=!1){return _typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(r?parentConditionalExpression():_typescript.default.factory.createThis(),_typescript.default.factory.createIdentifier(_pre_define.FOREACHUPDATEFUNCTION)),void 0,addForEachIdFuncParameter(e,t)))}function addForEachIdFuncParameter(e,t){var r=[];return r.push(_typescript.default.factory.createIdentifier(_pre_define.ELMTID),e[0],_typescript.default.factory.createIdentifier(_pre_define.FOREACHITEMGENFUNCTION)),t&&t.parameters&&t.parameters[1]&&(e[2]?e[2].parameters&&e[2].parameters[1]?r.push(...addForEachParameter(e[2],_pre_define.TRUE,_pre_define.TRUE)):r.push(...addForEachParameter(e[2],_pre_define.TRUE,_pre_define.FALSE)):r.push(...addForEachParameter(_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_IF_UNDEFINED),_pre_define.TRUE,_pre_define.FALSE))),t&&t.parameters&&t.parameters.length<2&&t.parameters[0]&&e&&2<e.length&&e[2]&&(e[2].parameters&&e[2].parameters[1]?r.push(...addForEachParameter(e[2],_pre_define.FALSE,_pre_define.TRUE)):r.push(...addForEachParameter(e[2],_pre_define.FALSE,_pre_define.FALSE))),r}function addForEachParameter(e,t,r){return[e,_typescript.default.factory.createIdentifier(t),_typescript.default.factory.createIdentifier(r)]}function createLazyForEachStatement(e){var t=[_typescript.default.factory.createStringLiteral(_utils.componentInfo.id.toString()),_typescript.default.factory.createThis(),e[0],_typescript.default.factory.createIdentifier(_pre_define.__LAZYFOREACHITEMGENFUNCTION)];return 3<=e.length&&e[2]&&t.push(_typescript.default.factory.createIdentifier(_pre_define.__LAZYFOREACHITEMIDFUNC)),_main.projectConfig.optLazyForEach&&t.push(_typescript.default.factory.createTrue()),_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_LAZYFOREACH),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CREATE_FUNCTION)),void 0,t))}function addForEachId(e,t=!1){var r=e.expression;return _typescript.default.factory.updateExpressionStatement(e,_typescript.default.factory.updateCallExpression(r,r.expression,r.typeArguments,[_typescript.default.factory.createStringLiteral((++_utils.componentInfo.id).toString()),t?parentConditionalExpression():_typescript.default.factory.createThis(),...r.arguments]))}function parentConditionalExpression(){return _typescript.default.factory.createConditionalExpression(_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CONSTRUCTOR_PARENT),_typescript.default.factory.createToken(_typescript.default.SyntaxKind.QuestionToken),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CONSTRUCTOR_PARENT),_typescript.default.factory.createToken(_typescript.default.SyntaxKind.ColonToken),_typescript.default.factory.createThis())}function processForEachFunctionBlock(e){return _typescript.default.isArrowFunction(e.arguments[1])?e.arguments[1]:_typescript.default.isParenthesizedExpression(e.arguments[1])&&_typescript.default.isArrowFunction(e.arguments[1].expression)?e.arguments[1].expression:null}function processForEachBlock(e,t,r,i=!1,a=!1,n=null){var s;return 1<e.arguments.length&&_typescript.default.isArrowFunction(r)?(e=e.expression.getText()===_pre_define.COMPONENT_LAZYFOREACH,s=r.body,_typescript.default.isBlock(s)?_main.partialUpdateConfig.partialUpdateMode?processComponentBlock(s,e,t,!1,!1,void 0,r.parameters,a,n).statements:_typescript.default.factory.updateArrowFunction(r,_typescript.default.getModifiers(r),r.typeParameters,r.parameters,r.type,r.equalsGreaterThanToken,processComponentBlock(s,e,t,!1,i,void 0,r.parameters)):(i=_typescript.default.factory.createExpressionStatement(s),s=_typescript.default.factory.createBlock([i],!0),i.parent=s,_main.partialUpdateConfig.partialUpdateMode?processComponentBlock(s,e,t,!1,!1,void 0,r.parameters,a,n).statements:_typescript.default.factory.updateArrowFunction(r,_typescript.default.getModifiers(r),r.typeParameters,r.parameters,r.type,r.equalsGreaterThanToken,processComponentBlock(s,e,t,!1,!1,void 0,r.parameters,a)))):null}function createRenderingInProgress(e){return _typescript.default.factory.createExpressionStatement(_typescript.default.factory.createBinaryExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createThis(),_typescript.default.factory.createIdentifier(_pre_define.IS_RENDERING_IN_PROGRESS)),_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsToken),e?_typescript.default.factory.createTrue():_typescript.default.factory.createFalse()))}function addElmtIdNode(){return _main.partialUpdateConfig.partialUpdateMode&&_main.projectConfig.optLazyForEach&&(_utils.storedFileInfo.processLazyForEach&&_utils.storedFileInfo.lazyForEachInfo.isDependItem||_utils.storedFileInfo.processBuilder)}function processIfStatement(e,t,r,i=!1,a=!1,n=null){var s=[],o=(addElmtIdNode()&&(s.push(createCollectElmtIdNode()),_utils.storedFileInfo.lazyForEachInfo.isDependItem=!1),createIfCreate()),r=processInnerIfStatement(e,0,r,i,a,n),i=(s.push(o,r),createIfPop());_main.partialUpdateConfig.partialUpdateMode?t.push(createComponentCreationStatement(e,s,_pre_define.COMPONENT_IF,a,!1,void 0,null,n),i):t.push(o,r,i)}function processInnerIfStatement(e,t,r,i=!1,a=!1,n=null){_typescript.default.isIdentifier(e.expression)&&void 0===e.expression.originalKeywordKind&&!e.expression.escapedText&&(r.push({type:_utils.LogType.ERROR,message:"Condition expression cannot be null in if statement.",pos:e.expression.getStart()}),e=_typescript.default.factory.updateIfStatement(e,_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_IF_UNDEFINED),e.thenStatement,e.elseStatement));var s=processThenStatement(e.thenStatement,t,r,i,a,n),t=processElseStatement(e.elseStatement,t,r,i,a,n);return _typescript.default.factory.updateIfStatement(e,e.expression,s,t)}function processThenStatement(e,t,r,i=!1,a=!1,n=null){return _typescript.default.isExpressionStatement(e)&&_typescript.default.isIdentifier(e.expression)&&void 0===e.expression.originalKeywordKind&&!e.expression.escapedText&&r.push({type:_utils.LogType.ERROR,message:"Then statement cannot be null in if statement.",pos:e.expression.getStart()}),e=e&&(_typescript.default.isBlock(e)?processIfBlock(e,t,r,i,a,n):_typescript.default.isIfStatement(e)?(e=processInnerIfStatement(e,0,r,i,a,n),_typescript.default.factory.createBlock(_main.partialUpdateConfig.partialUpdateMode?[createIfCreate(),createIfBranchFunc(t,[e],a),createIfPop()]:[createIfCreate(),createIfBranchId(t),e,createIfPop()],!0)):processIfBlock(e=_typescript.default.factory.createBlock([e],!0),t,r,i,a,n))}function processElseStatement(e,t,r,i=!1,a=!1,n=null){return e?e=_typescript.default.isBlock(e)?processIfBlock(e,t+1,r,i,a,n):_typescript.default.isIfStatement(e)?processInnerIfStatement(e,t+1,r,i,a,n):processIfBlock(e=_typescript.default.factory.createBlock([e],!0),t+1,r,i,a,n):_main.partialUpdateConfig.partialUpdateMode&&(e=_typescript.default.factory.createBlock([_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createThis(),_typescript.default.factory.createIdentifier(_pre_define.IFELSEBRANCHUPDATEFUNCTION)),void 0,[_typescript.default.factory.createNumericLiteral(++t),_typescript.default.factory.createArrowFunction(void 0,void 0,[],void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createBlock([],!0))]))],!0)),e}function processIfBlock(e,t,r,i=!1,a=!1,n=null){return addIfBranchId(t,a,processComponentBlock(e,!1,r,!1,i,_pre_define.COMPONENT_IF,void 0,a,n))}function addIfBranchId(e,t=!1,r){let i;return i=_main.partialUpdateConfig.partialUpdateMode?[createIfBranchFunc(e,[...r.statements],t)]:[createIfBranchId(e),...r.statements],_typescript.default.factory.updateBlock(r,i)}function createIf(){return _typescript.default.factory.createIdentifier(_pre_define.COMPONENT_IF)}function createIfCreate(){return _typescript.default.factory.createExpressionStatement(createFunction(createIf(),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CREATE_FUNCTION),_typescript.default.factory.createNodeArray([])))}function createIfPop(){return _typescript.default.factory.createExpressionStatement(createFunction(createIf(),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_POP_FUNCTION),null))}function createIfBranchId(e){return _typescript.default.factory.createExpressionStatement(createFunction(createIf(),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_IF_BRANCH_ID_FUNCTION),_typescript.default.factory.createNodeArray([_typescript.default.factory.createNumericLiteral(e)])))}function createIfBranchFunc(e,t,r=!1){return _typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(r?parentConditionalExpression():_typescript.default.factory.createThis(),_typescript.default.factory.createIdentifier(_pre_define.IFELSEBRANCHUPDATEFUNCTION)),void 0,[_typescript.default.factory.createNumericLiteral(e),_typescript.default.factory.createArrowFunction(void 0,void 0,[],void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createBlock(t,!0))]))}function createComponent(e,t){var r={newNode:e,identifierNode:null,isContainerComponent:!1,isButton:!1,needPop:!1};let i=_typescript.default.factory.createIdentifier(t),a=e.expression;for(;a&&!_typescript.default.isIdentifier(a)&&a.expression;)a=a.expression;return a&&a.parent&&(_typescript.default.isCallExpression(a.parent)||_typescript.default.isEtsComponentExpression(a.parent))&&_typescript.default.isIdentifier(a)&&(a.getText()===_pre_define.COMPONENT_BUTTON&&t!==_pre_define.COMPONENT_POP_FUNCTION&&(r.isButton=!0,i=t===_pre_define.COMPONENT_CREATE_CHILD_FUNCTION?_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CREATE_CHILD_FUNCTION):_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CREATE_LABEL_FUNCTION)),_component_map.NEEDPOP_COMPONENT.has(a.getText())&&(r.needPop=!0),checkContainer(a.getText(),a.parent)&&(r.isContainerComponent=!0),r.newNode=t===_pre_define.COMPONENT_POP_FUNCTION?_typescript.default.factory.createExpressionStatement(createFunction(a,i,null)):_typescript.default.factory.createExpressionStatement(createFunction(a,i,checkArguments(a,t))),r.identifierNode=a),r}function checkArguments(t,r){var i=this;const a=[];return _component_map.CUSTOM_BUILDER_CONSTRUCTORS.has(t.escapedText.toString())?(t.parent.arguments.forEach(function(e){_newArrowCheck(this,i),_typescript.default.isConditionalExpression(e)?a.push(processConditionalBuilder(e,t,r)):isBuilderChangeNode(e,t,r)?a.push(parseBuilderNode(e,r)):a.push(e)}.bind(this)),a):"XComponent"===t.getText()&&r===_pre_define.COMPONENT_CREATE_FUNCTION&&_main.projectConfig.moduleName&&_main.projectConfig.bundleName?t.parent.arguments.concat([_typescript.default.factory.createStringLiteral(_main.projectConfig.bundleName+"/"+_main.projectConfig.moduleName)]):t.parent.arguments}function checkContainer(e,t){return _component_map.BUILDIN_CONTAINER_COMPONENT.has(e)&&("XComponent"!==e||t&&t.arguments&&t.arguments.length&&_typescript.default.isObjectLiteralExpression(t.arguments[0])&&t.arguments[0].properties&&checkComponentType(t.arguments[0].properties))}function checkComponentType(e){var t=this;let r=!1;return e.forEach(function(e){_newArrowCheck(this,t),isXComponentContainer(e)&&(r=!0)}.bind(this)),r}function isXComponentContainer(e){return e.name&&_typescript.default.isIdentifier(e.name)&&e.name.getText()===_pre_define.RESOURCE_NAME_TYPE&&e.initializer&&(_typescript.default.isStringLiteral(e.initializer)&&(e.initializer.getText()===_pre_define.XCOMPONENT_SINGLE_QUOTATION||e.initializer.getText()===_pre_define.XCOMPONENT_DOUBLE_QUOTATION)||_typescript.default.isNumericLiteral(e.initializer)&&"1"===e.initializer.getText()||_typescript.default.isPropertyAccessExpression(e.initializer)&&e.initializer.expression&&_typescript.default.isIdentifier(e.initializer.expression)&&e.initializer.name&&_typescript.default.isIdentifier(e.initializer.name)&&e.initializer.expression.getText()===_pre_define.XCOMPONENTTYPE&&e.initializer.name.getText()===_pre_define.XCOMPONENTTYPE_CONTAINER)}function bindComponentAttr(e,t,r,i,a=!0,n=!1,s=null,o=!1,p=null){var c=validateStylesUIComponent(e,n);let d=e.expression;var f=[],l=[],_=[],u={statement:null,kind:!1,hasAnimationAttr:!1},y=(0,_process_custom_component.isRecycle)(_validate_ui_syntax.componentCollection.currentClassName);for((_typescript.default.isPropertyAccessExpression(d)||c)&&i.push({type:c?_utils.LogType.WARN:_utils.LogType.ERROR,message:`'${e.getText()}' does not meet UI component syntax.`,pos:e.getStart()});d&&_typescript.default.isCallExpression(d)&&d.expression;){let e=!1;if(d.expression&&(validatePropertyAccessExpressionWithCustomBuilder(d.expression)||validateIdentifierWithCustomBuilder(d.expression))){let e="";switch(_typescript.default.isIdentifier(d.expression)?e=d.expression.escapedText.toString():_typescript.default.isPropertyAccessExpression(d.expression)&&(e=d.expression.name.escapedText.toString()),!0){case _pre_define.BIND_POPUP_SET.has(e):d=processBindPopupBuilder(d);break;case _pre_define.BIND_DRAG_SET.has(e):d=processDragStartBuilder(d,e);break;default:d=processCustomBuilderProperty(d,t,e)}}if(_typescript.default.isPropertyAccessExpression(d.expression)&&d.expression.name&&_typescript.default.isIdentifier(d.expression.name)&&(!_validate_ui_syntax.componentCollection.customComponents.has(d.expression.name.getText())||_component_map.STYLES_ATTRIBUTE.has(d.expression.name.getText())))parseRecycleId(d,d.expression.name,y,p),addComponentAttr(d,d.expression.name,u,f,t,i,n,l,_,s,y,o),d=d.expression.expression,e=!0;else if(_typescript.default.isIdentifier(d.expression)){_component_map.INNER_COMPONENT_NAMES.has(d.expression.getText())||_component_map.GESTURE_TYPE_NAMES.has(d.expression.getText())||_validate_ui_syntax.componentCollection.customComponents.has(d.expression.getText())||(parseRecycleId(d,d.expression.name,y,p),addComponentAttr(d,d.expression,u,f,t,i,n,l,_,s,y,o));break}e||(d=d.expression)}u.statement&&u.kind&&f.push(u.statement),!y||u.hasAnimationAttr?f.length&&(a?r.push(...f.reverse()):r.push(...f)):(_.length&&(a?r.push(..._.reverse()):r.push(..._)),s&&l.length&&(a?s.push(...l.reverse()):s.push(...l)))}function validateStylesUIComponent(e,t){return(_typescript.default.isIfStatement(e)||_typescript.default.isSwitchStatement(e))&&t}function parseRecycleId(e,t,r,i){i&&((t=t.escapedText.toString())===_pre_define.RECYCLE_REUSE_ID?i.reuseId=e.arguments[0]:t===_pre_define.ATTRIBUTE_ID&&(i.hasIdAttr=!0),i.attrCount++)}function processCustomBuilderProperty(e,r,i){var a=this;const n=[];return e.arguments.forEach(function(e,t){_newArrowCheck(this,a),_typescript.default.isConditionalExpression(e)?n.push(processConditionalBuilder(e,r,i)):isBuilderChangeNode(e,r,i)?n.push(parseBuilderNode(e,i)):n.push(e)}.bind(this)),e=_typescript.default.factory.updateCallExpression(e,e.expression,e.typeArguments,n)}function isBuilderChangeNode(e,t,r){return _typescript.default.isPropertyAccessExpression(e)&&e.name&&_typescript.default.isIdentifier(e.name)&&_utils.storedFileInfo.builderLikeCollection.has(e.name.getText())||_typescript.default.isCallExpression(e)&&e.expression&&e.expression.name&&_typescript.default.isIdentifier(e.expression.name)&&_utils.storedFileInfo.builderLikeCollection.has(e.expression.name.getText())||_typescript.default.isIdentifier(e)&&e.escapedText&&_utils.storedFileInfo.builderLikeCollection.has(e.escapedText.toString())||_typescript.default.isObjectLiteralExpression(e)&&(_pre_define.BIND_OBJECT_PROPERTY.get(t.escapedText.toString())&&_pre_define.BIND_OBJECT_PROPERTY.get(t.escapedText.toString()).has(r)||_pre_define.BIND_OBJECT_PROPERTY.get(_pre_define.ALL_COMPONENTS).has(r))||_typescript.default.isCallExpression(e)&&e.expression&&_typescript.default.isIdentifier(e.expression)&&_utils.storedFileInfo.builderLikeCollection.has(e.expression.escapedText.toString())||isWrappedBuilder(e)||isWrappedBuilderCallExpression(e)}function isWrappedBuilder(e){return!!(11<=_main.projectConfig.minAPIVersion&&_typescript.default.isPropertyAccessExpression(e)&&e.name&&_typescript.default.isIdentifier(e.name)&&e.name.escapedText.toString()===_pre_define.WRAPBUILDER_BUILDERPROP&&_main.globalProgram.checker.getTypeAtLocation(e.expression)&&_main.globalProgram.checker.getTypeAtLocation(e.expression).symbol&&_main.globalProgram.checker.getTypeAtLocation(e.expression).symbol.escapedName===_pre_define.WRAPPEDBUILDER_CLASS)}function isWrappedBuilderCallExpression(e){return!!(11<=_main.projectConfig.minAPIVersion&&_typescript.default.isCallExpression(e)&&e.expression&&isWrappedBuilder(e.expression))}function parseBuilderNode(e,t){return isWrappedBuilder(e)||isPropertyAccessExpressionNode(e)?(_component_map.CUSTOM_BUILDER_PROPERTIES_WITHOUTKEY.has(t)?processPropertyBuilderWithoutKey:processPropertyBuilder)(e):_typescript.default.isIdentifier(e)&&_utils.storedFileInfo.builderLikeCollection.has(e.escapedText.toString())?(_component_map.CUSTOM_BUILDER_PROPERTIES_WITHOUTKEY.has(t)?processIdentifierBuilderWithoutKey:processIdentifierBuilder)(e):isWrappedBuilderCallExpression(e)||_typescript.default.isCallExpression(e)?(_component_map.CUSTOM_BUILDER_PROPERTIES_WITHOUTKEY.has(t)?getParsedBuilderAttrArgumentWithParamsWithoutKey:getParsedBuilderAttrArgumentWithParams)(e):_typescript.default.isObjectLiteralExpression(e)?processObjectPropertyBuilder(e):void 0}function processObjectPropertyBuilder(e){var t=this;const r=[];return e.properties.forEach(function(e){_newArrowCheck(this,t),e.name&&_typescript.default.isIdentifier(e.name)&&[_pre_define.CUSTOM_DIALOG_CONTROLLER_BUILDER,_pre_define.HEADER,_pre_define.INDICATORBUILDER,_pre_define.FOOTER,_pre_define.START,_pre_define.END,_pre_define.PREVIEW,_pre_define.TITLE].includes(e.name.escapedText.toString())&&e.initializer?isPropertyAccessExpressionNode(e.initializer)||_typescript.default.isIdentifier(e.initializer)&&_utils.storedFileInfo.builderLikeCollection.has(e.initializer.escapedText.toString())?r.push(_typescript.default.factory.updatePropertyAssignment(e,e.name,_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(e.initializer,_typescript.default.factory.createIdentifier(_pre_define.BUILDER_ATTR_BIND)),void 0,[_typescript.default.factory.createThis()]))):isGlobalBuilderCallExpressionNode(e.initializer)||isInnerBuilderCallExpressionNode(e.initializer)?r.push(transformBuilderCallExpression(e)):_typescript.default.isObjectLiteralExpression(e.initializer)?r.push(_typescript.default.factory.updatePropertyAssignment(e,e.name,processObjectPropertyBuilder(e.initializer))):r.push(e):r.push(e)}.bind(this)),_typescript.default.factory.updateObjectLiteralExpression(e,r)}function transDoubleDollarInCustomBuilder(e){let t="";return e.expression&&_typescript.default.isIdentifier(e.expression)?t=e.expression.escapedText.toString():e.expression&&_typescript.default.isPropertyAccessExpression(e.expression)&&e.expression.name&&_typescript.default.isIdentifier(e.expression.name)&&(t=e.expression.name.escapedText.toString()),1===e.arguments.length&&_typescript.default.isObjectLiteralExpression(e.arguments[0])?[_typescript.default.factory.createCallExpression(_typescript.default.factory.createIdentifier(_pre_define.BUILDER_PARAM_PROXY),void 0,[_typescript.default.factory.createStringLiteral(t),traverseBuilderParams(e.arguments[0],_utils.storedFileInfo.processBuilder)])]:e.arguments}function transformBuilderCallExpression(e){var t=transDoubleDollarInCustomBuilder(e.initializer);return _typescript.default.factory.updatePropertyAssignment(e,e.name,_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(e.initializer.expression,_typescript.default.factory.createIdentifier(_pre_define.BUILDER_ATTR_BIND)),void 0,[_typescript.default.factory.createThis(),...t||[]]))}function isInnerBuilderCallExpressionNode(e){return _typescript.default.isCallExpression(e)&&e.expression&&isPropertyAccessExpressionNode(e.expression)}function isGlobalBuilderCallExpressionNode(e){return _typescript.default.isCallExpression(e)&&e.expression&&_typescript.default.isIdentifier(e.expression)&&_component_map.CUSTOM_BUILDER_METHOD.has(e.expression.escapedText.toString())}function isPropertyAccessExpressionNode(e){return _typescript.default.isPropertyAccessExpression(e)&&e.expression&&e.expression.kind===_typescript.default.SyntaxKind.ThisKeyword&&e.name&&_typescript.default.isIdentifier(e.name)&&_utils.storedFileInfo.builderLikeCollection.has(e.name.escapedText.toString())}function processBindPopupBuilder(e){var r=this;const i=[];return e.arguments.forEach(function(e,t){_newArrowCheck(this,r),1===t&&_typescript.default.isObjectLiteralExpression(e)?i.push(processBindPopupBuilderProperty(e)):i.push(e)}.bind(this)),e=_typescript.default.factory.updateCallExpression(e,e.expression,e.typeArguments,i)}function processDragStartBuilder(t,r){var i=[];if(isNodeFunction(t)){for(let e=0;e<t.arguments[0].body.statements.length;e++){var a=t.arguments[0].body.statements[e];i.push(checkStatement(a,r))}t=_typescript.default.factory.updateCallExpression(t,t.expression,t.typeArguments,[_typescript.default.factory.updateArrowFunction(t.arguments[0],void 0,void 0,t.arguments[0].parameters,t.arguments[0].type,t.arguments[0].equalsGreaterThanToken,_typescript.default.factory.updateBlock(t.arguments[0].body,i))])}return t}function isNodeFunction(e){return e.arguments&&e.arguments.length&&_typescript.default.isArrowFunction(e.arguments[0])&&e.arguments[0].body&&_typescript.default.isBlock(e.arguments[0].body)}function checkStatement(t,r){if(_typescript.default.isReturnStatement(t)){var e;if(_typescript.default.isObjectLiteralExpression(t.expression)){var i=[];for(let e=0;e<t.expression.properties.length;e++){var a=checkProperty(t.expression.properties[e],r);i.push(a)}return _typescript.default.factory.createReturnStatement(_typescript.default.factory.createObjectLiteralExpression(i))}return e=processInitializer(e=t.expression,r),_typescript.default.factory.updateReturnStatement(t,e)}return t}function checkProperty(e,t){var r;return isPropertyFunction(e)&&(r=processInitializer(r=e.initializer,t),e=_typescript.default.factory.createPropertyAssignment(e.name,r)),e}function processInitializer(e,t){return e&&_typescript.default.isConditionalExpression(e)?processConditionalBuilder(e,_typescript.default.factory.createIdentifier(_pre_define.CUSTOM_COMPONENT_DEFAULT),t):isBuilderChangeNode(e,_typescript.default.factory.createIdentifier(_pre_define.CUSTOM_COMPONENT_DEFAULT),t)?parseBuilderNode(e,t):e}function isPropertyFunction(e){return _typescript.default.isPropertyAssignment(e)&&e.name&&_typescript.default.isIdentifier(e.name)&&e.name.escapedText.toString()===_pre_define.BUILDER_ATTR_NAME}function processBindPopupBuilderProperty(e){var i=this;const a=[];return e.properties.forEach(function(e,t){var r;_newArrowCheck(this,i),e.name&&_typescript.default.isIdentifier(e.name)&&e.initializer&&e.name.escapedText.toString()===_pre_define.CUSTOM_DIALOG_CONTROLLER_BUILDER?(r=processInitializer(r=e.initializer,_pre_define.BIND_POPUP),a.push(_typescript.default.factory.updatePropertyAssignment(e,e.name,r))):a.push(e)}.bind(this)),_typescript.default.factory.updateObjectLiteralExpression(e,a)}function processConditionalBuilder(e,t,r){let i=e.whenTrue,a=e.whenFalse;return isBuilderChangeNode(e.whenTrue,t,r)&&(i=parseBuilderNode(e.whenTrue,r)),isBuilderChangeNode(e.whenFalse,t,r)&&(a=parseBuilderNode(e.whenFalse,r)),_typescript.default.factory.createConditionalExpression(e.condition,e.questionToken,i,e.colonToken,a)}function processPropertyBuilder(e){return _typescript.default.factory.createObjectLiteralExpression([_typescript.default.factory.createPropertyAssignment(_typescript.default.factory.createIdentifier(_pre_define.BUILDER_ATTR_NAME),_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(e,_typescript.default.factory.createIdentifier(_pre_define.BUILDER_ATTR_BIND)),void 0,[_typescript.default.factory.createThis()]))])}function processPropertyBuilderWithoutKey(e){return _typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(e,_typescript.default.factory.createIdentifier(_pre_define.BUILDER_ATTR_BIND)),void 0,[_typescript.default.factory.createThis()])}function processIdentifierBuilder(e){return _typescript.default.factory.createObjectLiteralExpression([_typescript.default.factory.createPropertyAssignment(_typescript.default.factory.createIdentifier(_pre_define.BUILDER_ATTR_NAME),_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(e,_typescript.default.factory.createIdentifier(_pre_define.BUILDER_ATTR_BIND)),void 0,[_typescript.default.factory.createThis()]))])}function processIdentifierBuilderWithoutKey(e){return _typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(e,_typescript.default.factory.createIdentifier(_pre_define.BUILDER_ATTR_BIND)),void 0,[_typescript.default.factory.createThis()])}function getParsedBuilderAttrArgumentWithParams(e){var t=transDoubleDollarInCustomBuilder(e);return _typescript.default.factory.createObjectLiteralExpression([_typescript.default.factory.createPropertyAssignment(_typescript.default.factory.createIdentifier(_pre_define.BUILDER_ATTR_NAME),_typescript.default.factory.createArrowFunction(void 0,void 0,[],void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createBlock([_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(e.expression,_typescript.default.factory.createIdentifier(_pre_define.CALL)),void 0,[_typescript.default.factory.createThis(),...t]))],!0)))])}function getParsedBuilderAttrArgumentWithParamsWithoutKey(e){var t=transDoubleDollarInCustomBuilder(e);return _typescript.default.factory.createArrowFunction(void 0,void 0,[],void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createBlock([_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(e.expression,_typescript.default.factory.createIdentifier(_pre_define.CALL)),void 0,[_typescript.default.factory.createThis(),...t]))],!0))}function validatePropertyAccessExpressionWithCustomBuilder(e){return _typescript.default.isPropertyAccessExpression(e)&&e.name&&_typescript.default.isIdentifier(e.name)&&_component_map.CUSTOM_BUILDER_PROPERTIES.has(e.name.escapedText.toString())}function validateIdentifierWithCustomBuilder(e){return _typescript.default.isIdentifier(e)&&_component_map.CUSTOM_BUILDER_PROPERTIES.has(e.escapedText.toString())}function createArrowFunctionForDollar(e){return _typescript.default.factory.createArrowFunction(void 0,void 0,[_typescript.default.factory.createParameterDeclaration(void 0,void 0,_typescript.default.factory.createIdentifier(_pre_define.$$_NEW_VALUE),void 0,void 0,void 0)],void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createBlock([_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createBinaryExpression(e,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsToken),_typescript.default.factory.createIdentifier(_pre_define.$$_NEW_VALUE)))],!1))}function updateArgumentForExclamation(e){return _typescript.default.isNonNullExpression(e)&&_typescript.default.isNonNullExpression(e.expression)?e.expression.expression:e}function updateArgumentForDollar(e){if(_typescript.default.isElementAccessExpression(e))return _typescript.default.factory.updateElementAccessExpression(e,updateArgumentForDollar(e.expression),e.argumentExpression);if(_typescript.default.isIdentifier(e)){if(e.getText()===_pre_define.$$_THIS)return _typescript.default.factory.createThis();if(e.getText().match(/^\$\$(.|\n)+/))return _typescript.default.factory.createIdentifier(e.getText().replace(/\$\$/,""))}else if(_typescript.default.isPropertyAccessExpression(e))return _typescript.default.factory.updatePropertyAccessExpression(e,updateArgumentForDollar(e.expression),e.name);return e}function verifyComponentId(e,t,r,i){var a,n,s;!newsupplement.isAcceleratePreview&&r===_pre_define.ATTRIBUTE_ID&&_typescript.default.isStringLiteral(e.arguments[0])&&(r=e.arguments[0].text,e=_process_ui_syntax.transformLog.sourceFile.getLineAndCharacterOfPosition(getRealNodePos(t)),a=_process_ui_syntax.transformLog.sourceFile.fileName.replace(/\.ts$/,""),a=_path.default.resolve(_main.projectConfig.projectPath,a).replace(/\\+/g,"/"),n=e.line+1,e=e.character+1,_component_map.ID_ATTRS.has(r)?(s=_component_map.ID_ATTRS.get(r)).get("path")===a&&s.get("line")===n&&s.get("col")===e||i.push({type:_utils.LogType.WARN,message:`The current component id "${r}" is duplicate with `+`${s.get("path")}:${s.get("line")}:${s.get("col")}.`,pos:t.pos}):_component_map.ID_ATTRS.set(r,(new Map).set("path",a).set("line",n).set("col",e)))}class StyleResult{constructor(){_defineProperty(this,"doubleDollar",!1),_defineProperty(this,"doubleExclamation",!1)}}function isDoubleBind(e,t,r,i,a){return isDoubleDollarToChange(t,r,i,a)?e.doubleDollar=!0:!!isDoubleExclamationToChange(t,i,a)&&(e.doubleExclamation=!0)}function addComponentAttr(t,r,i,a,n,s,o,p,c,e=null,d=!1,f=!1){var l=new StyleResult,_=r.getText(),u=(verifyComponentId(t,r,_,s),{type:""});if(_===_pre_define.ATTRIBUTE_ANIMATION){var y=_typescript.default.factory.createExpressionStatement(createFunction(_typescript.default.factory.createIdentifier(_pre_define.GLOBAL_CONTEXT),r,[_typescript.default.factory.createNull()]));i.statement?a.push(i.statement,y):1===t.arguments.length&&t.arguments[0].kind===_typescript.default.SyntaxKind.NullKeyword||a.push(y),i.statement=_typescript.default.factory.createExpressionStatement(createFunction(_typescript.default.factory.createIdentifier(_pre_define.GLOBAL_CONTEXT),r,t.arguments)),i.kind=!1,i.hasAnimationAttr=!0}else if(_component_map.GESTURE_ATTRS.has(_))parseGesture(t,_,a,s,c),i.kind=!0;else if(isExtendFunctionNode(n,_,u)){newsupplement.isAcceleratePreview&&s.push({type:_utils.LogType.ERROR,message:"Doesn't support Extend function now",pos:t.getStart()});let e="";e=u.type===_pre_define.CHECK_COMPONENT_EXTEND_DECORATOR?`__${n.escapedText.toString()}__`+_:_;y=_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createIdentifier(e),void 0,u.type===_pre_define.CHECK_COMPONENT_EXTEND_DECORATOR?t.arguments:[...t.arguments,_typescript.default.factory.createIdentifier(_pre_define.ELMTID),_typescript.default.factory.createIdentifier(_pre_define.ISINITIALRENDER),_typescript.default.factory.createThis()]));a.push(y),c.push(y),i.kind=!0}else if(_===_pre_define.ATTRIBUTE_STATESTYLES)1===t.arguments.length&&_typescript.default.isObjectLiteralExpression(t.arguments[0])?(a.push(createViewStackProcessor(t,!0)),d&&c.push(createViewStackProcessor(t,!0)),traverseStateStylesAttr(t,a,n,s,c,e,d),i.kind=!0):validateStateStyleSyntax(t,s);else{if(_component_map.GLOBAL_STYLE_FUNCTION.has(_)||_component_map.INNER_STYLE_FUNCTION.has(_)){u=_component_map.INNER_STYLE_FUNCTION.get(_)||_component_map.GLOBAL_STYLE_FUNCTION.get(_);0<u.statements.length&&(bindComponentAttr(u.statements[0],n,a,s,!1,!0,e),d)&&bindComponentAttr(u.statements[0],n,c,s,!1,!0,e,!0)}else if(isDoubleBind(l,o,n,_,t)){y=[],u=(l.doubleDollar?classifyArgumentsNum(t.arguments,y,_,n):classifyArgumentsNumV2(t.arguments,y,_),_typescript.default.factory.createExpressionStatement(createFunction(n,r,y)));a.push(u),c.push(u)}else if(t=loopEtscomponent(t,o),_!==_pre_define.RECYCLE_REUSE_ID){let e=!1;[_pre_define.ATTRIBUTE_ATTRIBUTE_MODIFIER,_pre_define.ATTRIBUTE_CONTENT_MODIFIER,_pre_define.ATTRIBUTE_MENUITEM_CONTENT_MODIFIER].includes(_)&&(e=!0);s=_typescript.default.factory.createExpressionStatement(createFunction(n,r,t.arguments,e));a.push(s),(!d||o&&!f||isGestureType(n)||!filterRegularAttrNode(t.arguments)?c:p).push(s)}i.kind=!0}}function isGestureType(e){return _component_map.GESTURE_TYPE_NAMES.has(e.escapedText.toString())}function filterRegularAttrNode(e){var t=this;return e.every(function(e){return _newArrowCheck(this,t),isRegularAttrNode(e)}.bind(this))}function isRegularAttrNode(e){var t=this;if(_typescript.default.isObjectLiteralExpression(e))return e.properties.every(function(e){return _newArrowCheck(this,t),!!e.initializer&&isRegularAttrNode(e.initializer)}.bind(this));if(_typescript.default.isArrayLiteralExpression(e))return e.elements.every(function(e){return _newArrowCheck(this,t),isRegularAttrNode(e)}.bind(this));if(isLiteralNode(e))return!0;if(_typescript.default.isPropertyAccessExpression(e)&&_typescript.default.isIdentifier(e.expression)&&_typescript.default.isIdentifier(e.name)){if(_validate_ui_syntax.enumCollection.has(e.expression.escapedText.toString()))return!0;if(_main.globalProgram.checker)if(1056&_main.globalProgram.checker.getTypeAtLocation(e).flags)return!0;return!1}var r={isRegularNode:!1};return _typescript.default.isPropertyAccessExpression(e)&&traversePropNode(e,r),r.isRegularNode||!1}function isLiteralNode(e){return _typescript.default.isStringLiteral(e)||_typescript.default.isNumericLiteral(e)||_typescript.default.isArrowFunction(e)||[_typescript.default.SyntaxKind.TrueKeyword,_typescript.default.SyntaxKind.FalseKeyword].includes(e.kind)}function traversePropNode(e,t){e.expression.kind===_typescript.default.SyntaxKind.ThisKeyword&&_typescript.default.isIdentifier(e.name)&&_validate_ui_syntax.regularCollection.get(_validate_ui_syntax.componentCollection.currentClassName).has(e.name.escapedText.toString())?t.isRegularNode=!0:_typescript.default.isPropertyAccessExpression(e.expression)&&traversePropNode(e.expression,t)}function isDoubleDollarToChange(e,t,r,i){return!!(!e&&_pre_define.PROPERTIES_ADD_DOUBLE_DOLLAR.has(t.escapedText.toString())&&_pre_define.PROPERTIES_ADD_DOUBLE_DOLLAR.get(t.escapedText.toString()).has(r)||_pre_define.STYLE_ADD_DOUBLE_DOLLAR.has(r)&&i.arguments.length&&i.arguments[0])&&null!==i.arguments[0].getText().match(/^(?!\$\$\.)\$\$(.|\n)+/)}function isDoubleExclamationToChange(e,t,r){return!e&&_pre_define.STYLE_ADD_DOUBLE_EXCLAMATION.has(t)&&r.arguments.length&&r.arguments[0]&&_typescript.default.isNonNullExpression(r.arguments[0])&&_typescript.default.isNonNullExpression(r.arguments[0].expression)&&!_typescript.default.isNonNullExpression(r.arguments[0].expression.expression)}function isHaveDoubleDollar(e,t){return _typescript.default.isPropertyAssignment(e)&&e.name&&_typescript.default.isIdentifier(e.name)&&_pre_define.PROPERTIES_ADD_DOUBLE_DOLLAR.get(t).has(e.name.getText())&&e.initializer&&null!==e.initializer.getText().match(/^(?!\$\$\.)\$\$(.|\n)+/)}function loopEtscomponent(r,e){var i=this;return r.arguments.forEach(function(e,t){_newArrowCheck(this,i),_typescript.default.isEtsComponentExpression(e)?r.arguments[t]=_typescript.default.factory.createCallExpression(e.expression,void 0,e.arguments):!_typescript.default.isCallExpression(e)&&!_typescript.default.isNewExpression(e)||newsupplement.isAcceleratePreview||(r.arguments[t]=_typescript.default.visitEachChild(e,changeEtsComponentKind,_process_ui_syntax.contextGlobal))}.bind(this)),r}function changeEtsComponentKind(e){return _typescript.default.isEtsComponentExpression(e)?(e.kind=204,e):_typescript.default.visitEachChild(e,changeEtsComponentKind,_process_ui_syntax.contextGlobal)}function classifyArgumentsNum(e,t,r,i){var a;_pre_define.STYLE_ADD_DOUBLE_DOLLAR.has(r)&&2<=e.length?(a=updateArgumentForDollar(e[0]),t.push(generateObjectForDollar(a),...e.slice(1))):_pre_define.STYLE_ADD_DOUBLE_EXCLAMATION.has(r)&&2<=e.length?(a=updateArgumentForExclamation(e[0]),t.push(generateObjectForExclamation(a),...e.slice(1))):(_pre_define.PROPERTIES_ADD_DOUBLE_DOLLAR.has(i.escapedText.toString())&&1===e.length&&_pre_define.PROPERTIES_ADD_DOUBLE_DOLLAR.get(i.escapedText.toString()).has(r)||_pre_define.STYLE_ADD_DOUBLE_DOLLAR.has(r)&&1===e.length)&&(a=updateArgumentForDollar(e[0]),t.push(a,createArrowFunctionForDollar(a)))}function classifyArgumentsNumV2(e,t,r){_pre_define.STYLE_ADD_DOUBLE_EXCLAMATION.has(r)&&2<=e.length&&(r=updateArgumentForExclamation(e[0]),t.push(generateObjectForExclamation(r),...e.slice(1)))}function generateObjectForExclamation(e){return _typescript.default.factory.createObjectLiteralExpression([_typescript.default.factory.createPropertyAssignment(_typescript.default.factory.createIdentifier(_pre_define.$$_VALUE),e),_typescript.default.factory.createPropertyAssignment(_typescript.default.factory.createIdentifier(_pre_define.$_VALUE),_typescript.default.factory.createArrowFunction(void 0,void 0,[_typescript.default.factory.createParameterDeclaration(void 0,void 0,_typescript.default.factory.createIdentifier(_pre_define.$$_NEW_VALUE),void 0,void 0,void 0)],void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createBlock([_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createBinaryExpression(e,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsToken),_typescript.default.factory.createIdentifier(_pre_define.$$_NEW_VALUE)))],!1)))],!1)}function generateObjectForDollar(e){return _typescript.default.factory.createObjectLiteralExpression([_typescript.default.factory.createPropertyAssignment(_typescript.default.factory.createIdentifier(_pre_define.$$_VALUE),e),_typescript.default.factory.createPropertyAssignment(_typescript.default.factory.createIdentifier(_pre_define.$$_CHANGE_EVENT),createArrowFunctionForDollar(e))],!1)}function createViewStackProcessor(e,t){var r=[];return!t&&e.name&&r.push(_typescript.default.factory.createStringLiteral(e.name.getText())),_typescript.default.factory.createExpressionStatement(_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createIdentifier(_pre_define.VIEW_STACK_PROCESSOR),_typescript.default.factory.createIdentifier(_pre_define.VISUAL_STATE)),void 0,r))}function traverseStateStylesAttr(r,i,a,n,s,o=null,p=!1){var c=this;r.arguments[0].properties.reverse().forEach(function(e){var t;_newArrowCheck(this,c),_typescript.default.isPropertyAccessExpression(e.initializer)&&e.initializer.expression.getText()===_pre_define.THIS&&_component_map.INNER_STYLE_FUNCTION.get(e.initializer.name.getText())?(t=e.initializer.name.getText(),bindComponentAttr(_component_map.INNER_STYLE_FUNCTION.get(t).statements[0],a,i,n,!1,!0,o),p&&bindComponentAttr(_component_map.INNER_STYLE_FUNCTION.get(t).statements[0],a,s,n,!1,!0,o)):_typescript.default.isIdentifier(e.initializer)&&_component_map.GLOBAL_STYLE_FUNCTION.get(e.initializer.getText())?(t=e.initializer.getText(),bindComponentAttr(_component_map.GLOBAL_STYLE_FUNCTION.get(t).statements[0],a,i,n,!1,!0,o),p&&bindComponentAttr(_component_map.GLOBAL_STYLE_FUNCTION.get(t).statements[0],a,s,n,!1,!0,o)):_typescript.default.isObjectLiteralExpression(e.initializer)&&1===e.initializer.properties.length&&_typescript.default.isPropertyAssignment(e.initializer.properties[0])?(bindComponentAttr(_typescript.default.factory.createExpressionStatement(e.initializer.properties[0].initializer),a,i,n,!1,!0,o),p&&bindComponentAttr(_typescript.default.factory.createExpressionStatement(e.initializer.properties[0].initializer),a,s,n,!1,!0,o)):_typescript.default.isObjectLiteralExpression(e.initializer)&&0===e.initializer.properties.length||validateStateStyleSyntax(r,n),e.name&&(t=createViewStackProcessor(e,!1),i.push(t),p)&&s.push(t)}.bind(this))}function isExtendFunctionNode(e,t,r){var i,e=e.escapedText.toString();return _component_map.EXTEND_ATTRIBUTE.has(e)&&[..._component_map.EXTEND_ATTRIBUTE.get(e)].includes(t)?(r.type=_pre_define.CHECK_COMPONENT_EXTEND_DECORATOR,!0):!(!(i=_utils.storedFileInfo.getCurrentArkTsFile().animatableExtendAttribute).has(e)||![...i.get(e)].includes(t)||(r.type=_pre_define.CHECK_COMPONENT_ANIMATABLE_EXTEND_DECORATOR,0))}const gestureMap=new Map([[_pre_define.PRIORITY_GESTURE_ATTRIBUTE,_pre_define.GESTURE_ENUM_VALUE_HIGH],[_pre_define.PARALLEL_GESTURE_ATTRIBUTE,_pre_define.GESTURE_ENUM_VALUE_PARALLEL],[_pre_define.GESTURE_ATTRIBUTE,_pre_define.GESTURE_ENUM_VALUE_LOW]]);function parseGesture(e,t,r,i,a){var n=_typescript.default.factory.createExpressionStatement(createFunction(_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_GESTURE),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_POP_FUNCTION),null)),n=(r.push(n),a.push(n),parseGestureInterface(e,r,i,a),_typescript.default.factory.createNodeArray([_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createIdentifier(_pre_define.GESTURE_ENUM_KEY),_typescript.default.factory.createIdentifier(gestureMap.get(t)))])),i=(e.arguments&&1<e.arguments.length&&_typescript.default.isPropertyAccessExpression(e.arguments[1])&&n.push(e.arguments[1]),_typescript.default.factory.createExpressionStatement(createFunction(_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_GESTURE),_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CREATE_FUNCTION),n)));r.push(i),a.push(i)}function processGestureType(t,e,r,i,a=!1){var n=[],s=_typescript.default.factory.createExpressionStatement(t);let o=t.expression;for(;o&&!_typescript.default.isIdentifier(o)&&o.expression;)o=o.expression;if(o&&o.parent&&_typescript.default.isCallExpression(o.parent)&&_typescript.default.isIdentifier(o)&&_component_map.GESTURE_TYPE_NAMES.has(o.escapedText.toString()))if(n.push(_typescript.default.factory.createExpressionStatement(createFunction(o,_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_POP_FUNCTION),null))),o.escapedText.toString()===_pre_define.COMPONENT_GESTURE_GROUP){t=[];parseGestureInterface(o.parent,t,r,[],!0),n.push(...t.reverse()),bindComponentAttr(s,o,n,r,!1);let e=null;o.parent.arguments&&o.parent.arguments.length&&(e=_typescript.default.factory.createNodeArray([o.parent.arguments[0]])),n.push(_typescript.default.factory.createExpressionStatement(createFunction(o,_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CREATE_FUNCTION),e)))}else bindComponentAttr(s,o,n,r,!1),n.push(_typescript.default.factory.createExpressionStatement(createFunction(o,_typescript.default.factory.createIdentifier(_pre_define.COMPONENT_CREATE_FUNCTION),o.parent.arguments)));n.length&&(a?e.push(...n.reverse()):e.push(...n),a?i.push(...n.reverse()):i.push(...n))}function parseGestureInterface(e,t,r,i,a=!1){var n=this;e.arguments&&e.arguments.length&&e.arguments.forEach(function(e){_newArrowCheck(this,n),_typescript.default.isCallExpression(e)&&processGestureType(e,t,r,i,a)}.bind(this))}function getName(e){let t=e.expression,r;for(;t;){if(_typescript.default.isIdentifier(t)&&t.parent&&(_typescript.default.isCallExpression(t.parent)||_typescript.default.isEtsComponentExpression(t.parent))){r=t.escapedText.toString();break}if(_typescript.default.isPropertyAccessExpression(t)&&t.name&&_typescript.default.isIdentifier(t.name)&&isCustomAttributes(t)){r=t.name.escapedText.toString();break}t=t.expression}return r}function isCustomAttributes(e){return!(!e.expression||e.expression.getText()!==_pre_define.THIS)||!!(e.expression&&_typescript.default.isIdentifier(e.expression)&&e.expression.getText()===_pre_define.$$&&_process_ui_syntax.builderTypeParameter.params.includes(e.expression.getText()))||!_component_map.BUILDIN_STYLE_NAMES.has(e.name.escapedText.toString())}function isAttributeNode(e){let t=e.expression,r;for(;t;){if(_typescript.default.isCallExpression(t)&&t.expression&&_typescript.default.isIdentifier(t.expression)){r=t.expression.escapedText.toString();break}t=t.expression}return _component_map.BUILDIN_STYLE_NAMES.has(r)}var ComponentType=function(e){return e[e.innerComponent=0]="innerComponent",e[e.customComponent=1]="customComponent",e[e.forEachComponent=2]="forEachComponent",e[e.customBuilderMethod=3]="customBuilderMethod",e[e.builderParamMethod=4]="builderParamMethod",e[e.function=5]="function",e[e.builderTypeFunction=6]="builderTypeFunction",e[e.repeatComponent=7]="repeatComponent",e}(ComponentType||{});function isEtsComponent(e){let t=!1,r=e.expression;for(;r;)_typescript.default.isEtsComponentExpression(r)&&(t=!0),r=r.expression;return t}function isSomeName(e,t){var r=this;return Array.isArray(e)&&e.some(function(e){return _newArrowCheck(this,r),!!_typescript.default.isIdentifier(e.name)&&e.name.escapedText.toString()===t}.bind(this))}function isParamFunction(e){return e.expression&&_typescript.default.isCallExpression(e.expression)&&e.expression.expression&&_typescript.default.isIdentifier(e.expression.expression)}function getComponentType(e,t,r,i,a=void 0){let n=!0,s=!0;return a&&isSomeName(a,r)&&isParamFunction(e)&&(n=!1,s=!1),isEtsComponent(e)?_validate_ui_syntax.componentCollection.customComponents.has(r)?ComponentType.customComponent:ComponentType.innerComponent:!isPartMethod(e)&&_validate_ui_syntax.componentCollection.customComponents.has(r)?ComponentType.customComponent:r===_pre_define.COMPONENT_FOREACH||r===_pre_define.COMPONENT_LAZYFOREACH?ComponentType.forEachComponent:r===_pre_define.COMPONENT_REPEAT?ComponentType.repeatComponent:isLocalBuilderOrBuilderMethod(_component_map.CUSTOM_BUILDER_METHOD,n,r)||isWrappedBuilderExpression(e)||isLocalBuilderOrBuilderMethod(_component_map.INNER_CUSTOM_LOCALBUILDER_METHOD,s,r)?ComponentType.customBuilderMethod:_validate_ui_syntax.builderParamObjectCollection.get(_validate_ui_syntax.componentCollection.currentClassName)&&_validate_ui_syntax.builderParamObjectCollection.get(_validate_ui_syntax.componentCollection.currentClassName).has(r)?ComponentType.builderParamMethod:!_main.partialUpdateConfig.builderCheck&&_process_ui_syntax.builderTypeParameter.params.includes(r)&&judgeBuilderType(e)?ComponentType.builderTypeFunction:(["XComponent"].includes(i)||_component_map.CUSTOM_BUILDER_METHOD.has(i))&&_typescript.default.isCallExpression(e.expression)&&_typescript.default.isIdentifier(e.expression.expression)?ComponentType.function:(isAttributeNode(e)||t.push({type:_utils.LogType.ERROR,message:`'${e.getText()}' does not meet UI component syntax.`,pos:e.getStart()}),null)}function isLocalBuilderOrBuilderMethod(e,t,r){return e.has(r)&&t}function isPartMethod(e){return!!(_typescript.default.isCallExpression(e.expression)&&_typescript.default.isPropertyAccessExpression(e.expression.expression)&&e.expression.expression.expression&&e.expression.expression.expression.kind&&e.expression.expression.expression.kind===_typescript.default.SyntaxKind.ThisKeyword)}function isWrappedBuilderExpression(e){return!!(11<=_main.projectConfig.minAPIVersion&&e.expression&&isWrappedBuilderCallExpression(e.expression))}function judgeBuilderType(e){let t;if(_main.globalProgram.program?t=_main.globalProgram.program.getTypeChecker():_main.globalProgram.watchProgram&&(t=_main.globalProgram.watchProgram.getCurrentProgram().getProgram().getTypeChecker()),e.expression&&e.expression.expression&&t){e=t.getTypeAtLocation(e.expression.expression);if(e&&e.aliasSymbol&&e.aliasSymbol.escapedName===_pre_define.BUILDER_TYPE)return!0}return!1}function validateStateStyleSyntax(e,t){t.push({type:_utils.LogType.ERROR,message:".stateStyles doesn't conform standard.",pos:e.getStart()})}function getEtsComponentExpression(e){let t=e.expression;for(;t;){if(_typescript.default.isEtsComponentExpression(t))return t;t=t.expression}return null}function checkEtsAndIdInIf(e,t){let r=e.expression,i;for(;r&&!_typescript.default.isEtsComponentExpression(r);)!i&&t===_pre_define.COMPONENT_IF&&_typescript.default.isPropertyAccessExpression(r)&&r.name&&_typescript.default.isIdentifier(r.name)&&r.name.escapedText.toString()===_pre_define.ATTRIBUTE_ID&&r.parent&&r.parent.arguments&&r.parent.arguments.length&&(i=r.parent.arguments[0]),r=r.expression;return[r,i]}function checkIdInIf(e,t){let r=e.expression,i;for(;r;){if(t===_pre_define.COMPONENT_IF&&_typescript.default.isPropertyAccessExpression(r)&&r.name&&_typescript.default.isIdentifier(r.name)&&r.name.escapedText.toString()===_pre_define.ATTRIBUTE_ID&&r.parent&&r.parent.arguments&&r.parent.arguments.length){i=r.parent.arguments[0];break}r=r.expression}return i}function checkEtsComponent(e,t){e=getEtsComponentExpression(e);e&&(0,_validate_ui_syntax.checkAllNode)(e,new Set([..._component_map.INNER_COMPONENT_NAMES,..._validate_ui_syntax.componentCollection.customComponents]),_process_ui_syntax.transformLog.sourceFile,t)}function checkButtonParamHasLabel(t,r){if(t.arguments&&0!==t.arguments.length)for(let e=0;e<t.arguments.length;e++){var i=t.arguments[e];if(_typescript.default.isStringLiteral(i)||_typescript.default.isCallExpression(i)&&_typescript.default.isIdentifier(i.expression)&&i.expression.escapedText.toString()===_pre_define.RESOURCE)return void r.push({type:_utils.LogType.ERROR,message:"The Button component with a label parameter can not have any child.",pos:t.getStart()})}}function isLazyForEachChild(e){let t=e.parent;for(;t&&!_typescript.default.isEtsComponentExpression(t)&&!_typescript.default.isCallExpression(t);)t=t.parent;return!(!t||!t.expression||t.expression.escapedText?.toString()!==_pre_define.COMPONENT_LAZYFOREACH)}function processDollarEtsComponent(e,n){var r=this;const s=[];return e.forEach(function(e,t){var i=this;if(_newArrowCheck(this,r),_typescript.default.isObjectLiteralExpression(e)&&e.properties&&e.properties.length){const a=[];e.properties.forEach(function(e,t){var r;_newArrowCheck(this,i),isHaveDoubleDollar(e,n)?(r=updateArgumentForDollar(e.initializer),a.push(_typescript.default.factory.updatePropertyAssignment(e,e.name,generateObjectForDollar(r)))):a.push(e)}.bind(this)),s.push(_typescript.default.factory.updateObjectLiteralExpression(e,a))}else s.push(e)}.bind(this)),s}function createFunction(e,t,r,i=!1){var a=e.escapedText.toString(),n=t.escapedText.toString();return r&&r.length?(n===_pre_define.COMPONENT_CREATE_FUNCTION&&_pre_define.PROPERTIES_ADD_DOUBLE_DOLLAR.has(a)&&(r=processDollarEtsComponent(r,a)),checkCreateArgumentBuilder(e,t)&&(r=transformBuilder(r)),a===_pre_define.NAVIGATION&&n===_pre_define.COMPONENT_CREATE_FUNCTION&&_main.partialUpdateConfig.partialUpdateMode&&(r=navigationCreateParam(a,n,r))):r=navigationCreateParam(a,n),_typescript.default.factory.createCallExpression(i?_typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(_typescript.default.factory.createPropertyAccessExpression(e,t),_typescript.default.factory.createIdentifier(_pre_define.BUILDER_ATTR_BIND)),void 0,[_typescript.default.factory.createThis()]):_typescript.default.factory.createPropertyAccessExpression(e,t),void 0,r)}function navigationCreateParam(e,t,r=void 0,i=!1){var a=[],t=t===_pre_define.COMPONENT_CREATE_FUNCTION,n=_main.partialUpdateConfig.partialUpdateMode;let s=!0;return r&&r.length?a.push(...r):n&&t&&(e===_pre_define.NAVIGATION?(s=!1,a.push(_typescript.default.factory.createNewExpression(_typescript.default.factory.createIdentifier(_pre_define.NAV_PATH_STACK),void 0,[]))):e!==_pre_define.NAV_DESTINATION||i||a.push(_typescript.default.factory.createArrowFunction(void 0,void 0,[],void 0,_typescript.default.factory.createToken(_typescript.default.SyntaxKind.EqualsGreaterThanToken),_typescript.default.factory.createBlock([],!1)))),_pre_define.CREATE_ROUTER_COMPONENT_COLLECT.has(e)&&t&&n&&a.push(_typescript.default.factory.createObjectLiteralExpression(navigationOrNavDestinationCreateContent(e,s),!1)),a}function navigationOrNavDestinationCreateContent(e,t){var r=[];return r.push(_typescript.default.factory.createPropertyAssignment(_typescript.default.factory.createIdentifier(_pre_define.RESOURCE_NAME_MODULE),_typescript.default.factory.createStringLiteral(_main.projectConfig.moduleName||"")),_typescript.default.factory.createPropertyAssignment(_typescript.default.factory.createIdentifier(_pre_define.PAGE_PATH),_typescript.default.factory.createStringLiteral(_main.projectConfig.compileHar?"":_path.default.relative(_main.projectConfig.projectRootPath||"",_process_ui_syntax.resourceFileName).replace(/\\/g,"/").replace(/\.ets$/,"")))),e===_pre_define.NAVIGATION&&r.push(_typescript.default.factory.createPropertyAssignment(_typescript.default.factory.createIdentifier(_pre_define.IS_USER_CREATE_STACK),t?_typescript.default.factory.createTrue():_typescript.default.factory.createFalse())),r}function checkCreateArgumentBuilder(e,t){return!(t.escapedText.toString()!==_pre_define.COMPONENT_CREATE_FUNCTION||!_pre_define.CREATE_BIND_COMPONENT.has(e.escapedText.toString()))}function transformBuilder(e){var t=this;const r=[];return e.forEach(function(e){_newArrowCheck(this,t),r.push(parseCreateParameterBuilder(e))}.bind(this)),r}function parseCreateParameterBuilder(e){return _typescript.default.isObjectLiteralExpression(e)?processObjectPropertyBuilder(e):e}function checkNonspecificParents(e,t,r,i){_component_map.SPECIFIC_PARENT_COMPONENT.has(t)&&!_component_map.SPECIFIC_PARENT_COMPONENT.get(t).has(r)&&_component_map.INNER_COMPONENT_NAMES.has(r)&&(r=Array.from(_component_map.SPECIFIC_PARENT_COMPONENT.get(t)).join(","),i.push({type:_utils.LogType.ERROR,message:`The '${t}' component can only be nested in the '${r}' parent component.`,pos:e.expression.getStart()}))}