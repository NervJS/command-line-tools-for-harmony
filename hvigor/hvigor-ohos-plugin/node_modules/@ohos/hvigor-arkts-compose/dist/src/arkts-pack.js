"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.watch=exports.compileCodeSnippet=exports.loadAceBuildJson=exports.getResolveModules=exports.runArkPack=void 0;const fs_1=__importDefault(require("fs")),os_1=__importDefault(require("os")),path_1=__importDefault(require("path")),hvigor_arkts_base_1=require("@ohos/hvigor-arkts-base"),hvigor_logger_1=require("@ohos/hvigor-logger"),plugin_commonjs_1=__importDefault(require("@rollup/plugin-commonjs")),plugin_json_1=__importDefault(require("@rollup/plugin-json")),plugin_node_resolve_1=__importDefault(require("@rollup/plugin-node-resolve")),index_js_1=__importDefault(require("../src/plugins/node-resolve/index.js")),compile_event_factory_js_1=require("./analyzer/compile-event-factory.js"),compile_perf_js_1=require("./analyzer/compile-perf.js"),compose_error_js_1=require("./data/compose-error.js"),check_duplicate_filenames_plugin_js_1=require("./plugins/check-duplicate-filenames-plugin.js"),collect_importers_plugin_js_1=require("./plugins/collect-importers-plugin.js"),common_plugin_js_1=require("./plugins/common-plugin.js"),copy_plugin_js_1=__importDefault(require("./plugins/copy-plugin.js")),delete_plugin_js_1=__importDefault(require("./plugins/delete-plugin.js")),gc_plugin_js_1=require("./plugins/gc-plugin.js"),invalid_cache_plugin_js_1=require("./plugins/invalid-cache-plugin.js"),module_meta_info_plugin_js_1=require("./plugins/module-meta-info-plugin.js"),preview_resource_watcher_plugin_js_1=require("./plugins/preview-resource-watcher-plugin.js"),router_map_plugin_js_1=require("./plugins/router-map-plugin.js"),use_new_ohm_url_plugin_js_1=require("./plugins/use-new-ohm-url-plugin.js"),use_sensitive_check_plugin_js_1=require("./plugins/use-sensitive-check-plugin.js"),wait_async_plugin_js_1=require("./plugins/wait-async-plugin.js"),wrapper_chunk_plugin_js_1=require("./plugins/wrapper-chunk-plugin.js"),constants_js_1=require("./util/constants.js"),copy_resources_js_1=require("./util/copy-resources.js"),load_sdk_functions_js_1=require("./util/load-sdk-functions.js"),rust_support_platform_util_js_1=require("./util/rust-support-platform-util.js"),utils_js_1=require("./util/utils.js"),compile_code_snippet_js_1=require("./work-scripts/compile-code-snippet.js"),PROCESS_UN_HANDLED_REJECTION="unhandledRejection",PROCESS_UN_CAUGHT_EXCEPTION="uncaughtException",logger=hvigor_arkts_base_1.ArktsBaseLogger.getLogger("arkts-pack"),defaultProjectConfig={watchMode:"false",isPreview:!1,buildMode:constants_js_1.RELEASE,compileMode:constants_js_1.JSBUNDLE},getMergedConfig=e=>{const t={...defaultProjectConfig},r=new Set([...Object.keys(defaultProjectConfig),...Object.keys(e)]);for(const o of r)void 0!==e[o]&&(t[o]=e[o]);return t.arkTSVersion=e.arkTSVersion,t};function addCompilerLogMsg(e){let t=`${e}${os_1.default.EOL}`,r=1,o=0,s=0,n="",a="",i="";const l="[31m",u="[39m";return hvigor_arkts_base_1.ArktsBaseLogger.getLogEvents().forEach((e=>{if("error"===e.level){const t=new hvigor_logger_1.ArkTsErrorAdaptor(String(e.msg)).getErrorMessage();n+=`${l}${r} ERROR: ${t.message}`,t.solutions&&(n+=`${os_1.default.EOL} ${os_1.default.EOL}* Try the following:`,t.solutions.forEach((e=>{n+=`${os_1.default.EOL}> ${e}`}))),t.moreInfo&&(n+=`${os_1.default.EOL}${l}> More Info: ${t.moreInfo}${os_1.default.EOL}`),n+=`${os_1.default.EOL}${u}${os_1.default.EOL}`,r++}"warn"===e.level&&(o++,a+=`[33m${o} WARN: ${e.msg}${u}${os_1.default.EOL}`),"info"===e.level&&(s++,i+=`[34m${s} INFO: ${e.msg}${u}${os_1.default.EOL}`)})),t=`${t}${i}${a}${n}${l}COMPILE RESULT:FAIL {ERROR:${r}`+(0===o?"":` WARN:${o}`)+`${0===s?"":` INFO:${s}`}}${u}`,t}let watcher,isWatchFirst=!0;const setWatcher=e=>{watcher=e};function registerCatchUnhandleError(e,t,r,o){process.on(PROCESS_UN_HANDLED_REJECTION,(e=>{throw e})),process.on(PROCESS_UN_CAUGHT_EXCEPTION,(s=>{if("true"===e.watchMode)return watcher?.resolveDonePromise(),o?.error(s),void r?.postMessage(isWatchFirst?{event:hvigor_arkts_base_1.WatchEvent.WATCH_WORK_ERROR}:{type:hvigor_arkts_base_1.WatchEvent.WATCH_RESULT,content:!1});if(s.name===compose_error_js_1.ARKTS_COMPILER_ERROR_NAME){const e=s,r=new Error(addCompilerLogMsg(s.message));throw e.stack&&r.stack&&(r.stack=r.stack.concat(os_1.default.EOL).concat(e.stack)),t(r),r}throw s}))}function getRollupErrorMessage(e){return e.loc&&e.loc.file?`${e.message+os_1.default.EOL+e.loc.file}:${e.loc.line}`:e.message}function noop(){}async function runArkPack(e,t,r,o,s,n){e.startEvent=e=>compile_event_factory_js_1.CompileEventFactory.createEvent(e,0,0).start(),e.endEvent=e=>compile_event_factory_js_1.CompileEventFactory.getEventById(e)?.stop();const a=new compile_perf_js_1.CompilePerf(e.perf).clear();let i;hvigor_arkts_base_1.ArktsBaseLogger.clearLogEvents(),isWatchFirst=!0,registerCatchUnhandleError(e,t,o,s);let l=noop;try{l=await collectCompilePerf(e,a,r,o,s,n)}catch(e){if(e instanceof Error){const t="RollupError"===e.name?getRollupErrorMessage(e):e.message;i=new compose_error_js_1.ArkTsCompilerError(t,e.stack)}else i="string"==typeof e?new Error(e):e}if(isWatchFirst=!1,hvigor_arkts_base_1.ArktsBaseLogger.checkLoggerHaveErrorInfo()&&"true"!==e.watchMode&&!i&&(i=new compose_error_js_1.ArkTsCompilerError("ArkTS Compiler Error")),"true"!==e.watchMode&&clearWorkerProcessContext(),i){if(i.name===compose_error_js_1.ARKTS_COMPILER_ERROR_NAME){const e=new Error(addCompilerLogMsg(i.message));i.stack&&e.stack&&(e.stack=e.stack.concat(os_1.default.EOL).concat(i.stack)),i=e}return await l(!1),{compileLogEvents:[],compileEvents:[],isSuccess:!1,error:i}}return await l(!0),{compileLogEvents:hvigor_arkts_base_1.ArktsBaseLogger.getLogEvents(),compileEvents:updateEventNames(Array.from(a.transform())),isSuccess:!0}}async function collectCompilePerf(e,t,r,o,s,n){const a=e.startEvent("generate configuration information"),i=generateConfig(e,s,n);if(validComposedOhPackagePathMap(e),checkRustResolver(e,s),e.endEvent(a.getId()),i.input&&Object.keys(i.input).length>0){const a=()=>e.isPreview&&o&&(0,compile_code_snippet_js_1.initServer)(e.cachePath,e.aceModuleBuild,e.etsLoaderPath,o),l=e=>{s?.error(e)},u=await(0,hvigor_arkts_base_1.runHvigorCompile)(i,r,o,a,setWatcher,l,n);return collectTimers(u.timing,t),u.callback??noop}return noop}function checkRustResolver(e,t){e.useNativeResolver&&!(0,rust_support_platform_util_js_1.isSupportedPlatform)()&&t?.warn("ohos.nativeResolver not supported on the current operating system.")}function collectTimers(e,t){if(e)for(const[r,[o,s,n,a,i,l,u]]of Object.entries(e))t.collect({name:r,time:o,startTime:s,endTime:n,frequency:a,memory:i,totalMemory:u,startMemory:l})}function clearProcessListeners(){process.removeAllListeners(PROCESS_UN_CAUGHT_EXCEPTION),process.removeAllListeners(PROCESS_UN_HANDLED_REJECTION)}function clearWorkerProcessContext(){(0,load_sdk_functions_js_1.clearSdkContext)(),clearProcessListeners()}function getResolveModules(e){const t=e.packageManagerType===constants_js_1.OHPM?constants_js_1.OH_NODE_MODULES:constants_js_1.NODE_MODULES,r=path_1.default.resolve(e.projectTopDir),o=path_1.default.resolve(e.modulePath),s=e.buildGeneratedProfilePath;return e.resolveModulePaths=[path_1.default.resolve(o,"src/main"),s,path_1.default.resolve(o,t),path_1.default.resolve(r,t)],e.resolveModulePaths}function loadAceBuildJson(e){if(e&&fs_1.default.existsSync(e))try{return JSON.parse(fs_1.default.readFileSync(e).toString())}catch(e){logger.error(`parse loader.json failed: ${e.message}`)}return{}}function getPlugins(e,t,r){const o=[...getBuiltInPlugins(e,r)],s=loadCustomCompilePlugins(e.hvigorPluginFile,t);e.compilePluginPath&&s.push(...loadCustomCompilePlugins(e.compilePluginPath,t)),s.forEach((r=>{const s=r.order??"last";if("first"===s&&o.unshift(doWrapper(r,e)),"last"===s&&o.push(doWrapper(r,e)),"function"==typeof s){const n={};o.forEach(((e,t)=>{let r=e.name,o=1;for(;n[r];)r=`${r}_${o}`,o++;n[r]=t}));const a=s(n);"number"!=typeof a&&t?._buildError(`'${e.hvigorPluginFile}' exports an invalid plugin '${r.name}' with invalid order return '${a}'. Must return a number value.`)._printErrorAndExit(),o.splice(a<0?0:a,0,doWrapper(r,e))}}));const n=checkPluginDuplicateName(o);return n&&t?._buildError(`'${e.compilePluginPath}' exports an invalid plugin whose name '${n}' duplicate with other plugins. Please rename this plugin.`)._printErrorAndExit(),o}function checkPluginDuplicateName(e){const t=e.map((e=>e.name)),r=new Set;for(const e of t){if(r.has(e))return e;r.add(e)}}function getSupportExtensions(){return[...new Set(constants_js_1.SUPPORT_EXTENSIONS.concat(load_sdk_functions_js_1.sdkSupportExtensions))]}function getBuiltInPlugins(e,t){const r=getSupportExtensions();return[e.isPreview&&e.appResource&&(0,preview_resource_watcher_plugin_js_1.previewResourceWatcherPlugin)(generatePreviewResourceFiles(e)),(e.isFaMode||"true"===e.watchMode)&&(0,copy_plugin_js_1.default)({targets:(0,copy_resources_js_1.getCopyPluginConfig)(e,e.appResource)}),(0,common_plugin_js_1.commonPlugin)(e,t),(0,invalid_cache_plugin_js_1.invalidCachePlugin)(),(0,check_duplicate_filenames_plugin_js_1.checkDuplicatedFileNamesPlugin)(),e.compileMode===constants_js_1.ESMODULE&&(0,module_meta_info_plugin_js_1.moduleMetaInfoPlugin)(r),getResolvePlugin(e,r),(0,router_map_plugin_js_1.routerMapPlugin)(),(0,use_new_ohm_url_plugin_js_1.newOhmUrlPlugin)(),(0,use_sensitive_check_plugin_js_1.sensitiveCheckPlugin)(),(0,plugin_commonjs_1.default)(),(0,gc_plugin_js_1.gcPlugin)(),(0,plugin_json_1.default)(),(0,wrapper_chunk_plugin_js_1.wrapperChunkPlugin)(),(0,wait_async_plugin_js_1.waitAsyncPlugin)(),(0,collect_importers_plugin_js_1.collectImportersPlugin)(e),...load_sdk_functions_js_1.sdkPlugins,!e.isPreview&&(0,delete_plugin_js_1.default)({targets:load_sdk_functions_js_1.cleanConfig,runOnce:!0})].filter((e=>"object"==typeof e))}function getResolvePlugin(e,t){const r=getResolveModules(e),o=e.globalModulePaths??[];return o.push(path_1.default.resolve(e.etsLoaderPath,"../../api")),e.packageManagerType===constants_js_1.OHPM?(0,index_js_1.default)({extensions:t,modulePaths:Array.from(new Set([path_1.default.resolve(constants_js_1.OH_NODE_MODULES),...r])),useRealpathCache:!0,preferBuiltins:!1,pkgNameToPkgInfo:e.pkgNameToPkgBriefInfo,caseSensitiveCheck:e.caseSensitiveCheck,useNativeResolver:e.useNativeResolver&&(0,rust_support_platform_util_js_1.isSupportedPlatform)(),sdkModulesPath:o}):(0,plugin_node_resolve_1.default)({extensions:t,modulePaths:Array.from(new Set([path_1.default.resolve(constants_js_1.NODE_MODULES),path_1.default.resolve(e.etsLoaderPath,constants_js_1.NODE_MODULES),...r])),preferBuiltins:!1})}function generatePreviewResourceFiles(e){return[path_1.default.resolve(__dirname,e.appResource),(0,utils_js_1.getOhPackageJsonPath)(path_1.default.resolve(e.modulePath,e.packageManagerType===constants_js_1.OHPM?constants_js_1.OH_PACKAGE_JSON5:constants_js_1.PACKAGE_JSON))]}function loadCustomCompilePlugins(e,t){const r=[];if(!e)return r;let o;delete require.cache[require.resolve(e)];try{o=require(e).default}catch(t){throw t.message=`${t.message} ${e}`,t}o||t?._buildError(`'${e}' has no default export.`)._printErrorAndExit();return(Array.isArray(o)?o:[o]).forEach((o=>{validatePlugin(o,e,t),o||t?._buildError(`'${e}' exports an undefined plugin.`)._printErrorAndExit(),r.push(o)})),r}function validatePlugin(e,t,r){"object"!=typeof e&&r?._buildError(`'${t}' exports an invalid plugin with type '${typeof e}'.`)._printErrorAndExit();const o=e.name;o||r?._buildError(`'${t}' exports an invalid plugin without a name.`)._printErrorAndExit(),"string"!=typeof o&&r?._buildError(`'${t}' exports an invalid plugin whose name is not a string.`)._printErrorAndExit(),Object.keys(e).forEach((s=>{const n=e[s];switch(s){case"name":break;case"order":n&&"last"!==n&&"first"!==n&&"function"!=typeof n&&r?._buildError(`'${t}' exports an invalid plugin '${o}' with unknown order '${n}'.`)._printErrorAndExit();break;case"buildStart":case"resolveId":case"load":case"transform":case"shouldInvalidCache":case"moduleParsed":case"beforeBuildEnd":case"buildEnd":n&&"function"!=typeof n&&r?._buildError(`'${t}' exports an invalid plugin '${o}' whose hook '${s}' is not a function.`)._printErrorAndExit();break;default:r?.warn(`'${t}' exports an invalid plugin '${o}' with unknown property: '${s}'.`)}}))}function manualChunks(e,{getModuleInfo:t}){if(e.includes(constants_js_1.NODE_MODULES)||e.includes(constants_js_1.OH_NODE_MODULES))return"commons";const r=t(e);return r&&!r.isEntry?"vendors":void 0}function getCompileInputObject(e){const t={};return Object.entries(e).forEach((([e,r])=>{if(!r.endsWith(".d.ts")&&!r.endsWith(".d.ets")){const o=e.startsWith("../")?`relative/../${e}`:e;t[o]=r}})),t}function processMockConfigModuleInfos(e){const t=e.mockParams?.mockConfigKey2ModuleInfo;if(!t||!Object.keys(t).length)return;const r=getSupportExtensions();Object.keys(t).forEach((e=>{const o=t[e],s=(0,hvigor_arkts_base_1.findSuitableFilePath)(o.filePath,r);s?o.filePath=s:delete t[e]}))}function getCompileEnv(e,t){return[e.compileSdkVersion,e.compatibleSdkVersion,e.runtimeOS,e.etsLoaderPath,!!e.obfuscationOptions?.selfConfig?.ruleOptions?.enable,t.moduleType,path_1.default.resolve(t.cachePath,hvigor_arkts_base_1.MSGPACK_COMPILE_CACHE_DIR_NAME)].join("#")}function generateConfig(e,t,r){const o=getMergedConfig(e);(0,load_sdk_functions_js_1.loadSdkFunctions)(o);const s=o.compileMode?.toLowerCase(),n=o.buildMode?.toLowerCase(),a=o.cachePath,i=n===constants_js_1.DEBUG?path_1.default.resolve(__dirname,o.aceModuleBuild):path_1.default.join(a,"releaseAssets",path_1.default.basename(o.aceModuleBuild)),l=getCompileEnv(e,o),u=r?.mount("KeyManager"),c=u?.getCache(`${e.modulePath}:${e.targetName}`);return c&&c!==l&&r?.unmount(c),u?.setCache(`${e.modulePath}:${e.targetName}`,l,!0),o.compileEnv=l,processMockConfigModuleInfos(o),{perf:e.perf===constants_js_1.AnalyzeMode.VERBOSE,unsupportedChangedFiles:[(0,utils_js_1.getOhPackageJsonPath)(path_1.default.resolve(e.modulePath,e.packageManagerType===constants_js_1.OHPM?constants_js_1.OH_PACKAGE_JSON5:constants_js_1.PACKAGE_JSON))],generateModuleGraphOnly:s===constants_js_1.ESMODULE,input:getCompileInputObject("true"===e.widgetCompile?load_sdk_functions_js_1.widgetEntryObj:load_sdk_functions_js_1.entryObj),output:getOutputConfig(i,s,e),shimMissingExports:!0,preserveSymlinks:!1,context:"globalThis",treeshake:n===constants_js_1.RELEASE,disableGenerateBundle:s===constants_js_1.ESMODULE,plugins:getPlugins(o,t,r),watch:getWatchConfig(s),watchMode:e.watchMode,enableFileSystemCache:!0,cacheDirectory:a,onwarn(e){onRollupWarn(e.message,e.code,o.isFaMode)},startEvent:e.startEvent,endEvent:e.endEvent,isPreview:e.isPreview,skipBuildEnd:e.skipBuildEnd,compileEnv:l,pkgName2SourceRoots:(0,utils_js_1.getPkgName2SourceRootsMap)(e),extensions:getSupportExtensions(),depName2RootPath:e.depName2RootPath,modulePath:e.modulePath,isByteCodeHar:e.byteCodeHar,declaredFilesPath:e.declaredFilesPath,useAcornLoose:!e.shouldEmitJs,bundledDependencies:e.projectArkOption?.bundledDependencies,arkCompileCachePath:e.arkCompileCachePath,buildMode:e.buildMode}}function getOutputConfig(e,t,r){return[{dir:e,chunkFileNames:"[name].js",format:"cjs",sourcemap:t===constants_js_1.JSBUNDLE&&!r.isPreview,sourcemapExcludeSources:!0,sourcemapPathTransform:(e,t)=>{if(r.buildMode===constants_js_1.RELEASE){const o=loadAceBuildJson(r.aceBuildJson);return path_1.default.resolve(path_1.default.dirname(t),e).replace(o.projectRootPath,"")}return path_1.default.resolve(path_1.default.dirname(t),e).replace(r.projectTopDir+path_1.default.sep,"")},exports:"named",sanitizeFileName:!1,bundleMode:t===constants_js_1.JSBUNDLE,manualChunks:r.supportChunks?manualChunks:void 0}]}function getWatchConfig(e){return{chokidar:{useFsEvents:!1},skipWrite:e===constants_js_1.ESMODULE,buildDelay:100}}exports.runArkPack=runArkPack,exports.getResolveModules=getResolveModules,exports.loadAceBuildJson=loadAceBuildJson;var compile_code_snippet_js_2=require("./work-scripts/compile-code-snippet.js");function watch(e,t,r,o,s){return e.watchMode="true",runArkPack(e,t,r,o,s)}function wrapperBeforeBuildEnd(e,t){return function(r){const o=getCompilePluginContext(this);let s;try{s=e.beforeBuildEnd.apply(o,[r])}catch(e){throw e.message=`${e.message} ${t.hvigorPluginFile}`,e}return s}}function wrapperBuildEnd(e,t){return function(r){const o=getCompilePluginContext(this);try{e.buildEnd.apply(o,[r])}catch(e){throw e.message=`${e.message} ${t.hvigorPluginFile}`,e}}}function wrapperModuleParsed(e,t){return function(r){const o=getCompilePluginContext(this);try{e.moduleParsed.apply(o,[r])}catch(e){throw e.message=`${e.message} ${t.hvigorPluginFile}`,e}}}function wrapperShouldInvalidCache(e,t){return function(r){const o=getCompilePluginContext(this);let s;try{s=e.shouldInvalidCache.apply(o,[r])}catch(e){throw e.message=`${e.message} ${t.hvigorPluginFile}`,e}return s}}function wrapperTransform(e,t){return function(r,o){const s=getCompilePluginContext(this);let n;try{n=e.transform.apply(s,[r,o])}catch(e){throw e.message=`${e.message} ${t.hvigorPluginFile}`,e}return n}}function wrapperLoad(e,t){return function(r){const o=getCompilePluginContext(this);let s;try{s=e.load.apply(o,[r])}catch(e){throw e.message=`${e.message} ${t.hvigorPluginFile}`,e}return s}}function wrapperResolveId(e,t){return function(r,o,s){const n=getCompilePluginContext(this);let a;try{a=e.resolveId.apply(n,[r,o,s])}catch(e){throw e.message=`${e.message} ${t.hvigorPluginFile}`,e}return a}}function validComposedOhPackagePathMap(e){e.ohPackagePathMap&&e.ohPackagePathMap.forEach(((e,t)=>{utils_js_1.composeOhPackagePathMap.set(t,e)}))}function wrapperBuildStart(e,t){return function(r){const o=getCompilePluginContext(this);try{e.buildStart.apply(o)}catch(e){throw e.message=`${e.message} ${t.hvigorPluginFile}`,e}}}function doWrapper(e,t){const r={name:e.name};return e.buildStart&&(r.buildStart=wrapperBuildStart(e,t)),e.resolveId&&(r.resolveId=wrapperResolveId(e,t)),e.load&&(r.load=wrapperLoad(e,t)),e.transform&&(r.transform=wrapperTransform(e,t)),e.shouldInvalidCache&&(r.shouldInvalidCache=wrapperShouldInvalidCache(e,t)),e.moduleParsed&&(r.moduleParsed=wrapperModuleParsed(e,t)),e.beforeBuildEnd&&(r.beforeBuildEnd=wrapperBeforeBuildEnd(e,t)),e.buildEnd&&(r.buildEnd=wrapperBuildEnd(e,t)),r}function getCompilePluginContext(e){return{getFileName:t=>e.getFileName(t),getModuleIds:()=>e.getModuleIds(),getModuleInfo:t=>e.getModuleInfo(t),parse:(t,r)=>e.parse(t,r),share:e.share}}function updateEventNames(e){const[t,r]=initUpdateEventNameHandler(),o=["beforeBuildEnd","buildEnd","afterBuildEnd","beforeBuild","buildStart","afterBuildStart","resolveId","load","resolveDynamicImport","shouldTransformCachedModule","transform","moduleParsed"];return e.forEach((e=>{const s=e.getName(),n=s.lastIndexOf("-");if(t.has(s))t.get(s)(e);else for(const t of o)if(s.endsWith(t)){const o=r.get(t);o&&o(e,s,n);break}})),e}function onRollupWarn(e,t,r=!1){"SHIMMED_EXPORT"===t||r&&"SOURCEMAP_BROKEN"===t||console.warn("[33m",e,"[39m")}function getCallback(e){return t=>t.setName(e)}function initUpdateEventNameHandler(){const e=new Map;e.set("# BUILD",getCallback("generate build graph for source files")),e.set("## initialize",getCallback("initialize compiler input")),e.set("## generate module graph",getCallback("generate module graph")),e.set("## sort and bind modules",getCallback("sort and bind modules")),e.set("## mark included statements",getCallback("mark included statements")),e.set("## before build end",getCallback("before build end")),e.set("## build end",getCallback("build end")),e.set("## after build end",getCallback("after build end"));const t=new Map;return t.set("beforeBuildEnd",((e,t,r)=>e.setName(`${t.substring(0,r)}- execute hook function before build ends`))),t.set("buildEnd",((e,t,r)=>e.setName(`${t.substring(0,r)}- execute hook function when build ends`))),t.set("afterBuildEnd",((e,t,r)=>e.setName(`${t.substring(0,r)}- execute hook function after build ends`))),t.set("beforeBuild",((e,t,r)=>e.setName(`${t.substring(0,r)}- execute hook function before build starts`))),t.set("buildStart",((e,t,r)=>e.setName(`${t.substring(0,r)}- execute hook function when build starts`))),t.set("afterBuildStart",((e,t,r)=>e.setName(`${t.substring(0,r)}- execute hook function after build starts`))),t.set("resolveId",((e,t,r)=>e.setName(`${t.substring(0,r)}- resolve file ID`))),t.set("load",((e,t,r)=>e.setName(`${t.substring(0,r)}- load file content`))),t.set("resolveDynamicImport",((e,t,r)=>e.setName(`${t.substring(0,r)}- resolve dynamic import`))),t.set("shouldTransformCachedModule",((e,t,r)=>e.setName(`${t.substring(0,r)}- decide whether to transform cached module`))),t.set("transform",((e,t,r)=>e.setName(`${t.substring(0,r)}- transform file content`))),t.set("moduleParsed",((e,t,r)=>e.setName(`${t.substring(0,r)}- execute hook function when module parsed`))),[e,t]}Object.defineProperty(exports,"compileCodeSnippet",{enumerable:!0,get:function(){return compile_code_snippet_js_2.compileCodeSnippet}}),exports.watch=watch;