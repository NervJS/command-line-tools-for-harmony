"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ArktsBaseLogger=exports.LogCore=void 0;const hvigor_logger_1=require("@ohos/hvigor-logger"),constants_js_1=require("../util/constants.js");class LogCore{constructor(e,s){this._debugLog=[],this._infoLog=[],this._warnLog=[],this._errorLog=[],this._log=[],this._category=e,this._type=s}getDebugLogs(){return this._debugLog}debug(...e){this.logMsg(this._debugLog,this.getLogEvent("debug",e))}getInfoLogs(){return this._infoLog}info(...e){this.logMsg(this._infoLog,this.getLogEvent("info",e))}getWarnLogs(){return this._warnLog}warn(...e){this.logMsg(this._warnLog,this.getLogEvent("warn",e))}getErrorLogs(){return this._errorLog}error(...e){this.logMsg(this._errorLog,this.getLogEvent("error",e))}getLogs(){return this._log}logMsg(e,s){e.push(s),this._log.push(s),ArktsBaseLogger.addLogEvent(s)}getLogEvent(e,s){return{time:new Date,category:this._category,level:e,msg:(t=s,t.map((e=>"object"==typeof e?JSON.stringify(e):e)).join(" ")),type:this._type};var t}}exports.LogCore=LogCore;class ArktsBaseLogger{static setLogCallback(e,s){ArktsBaseLogger.sendLog=e,ArktsBaseLogger.tsWatchCb=s}static addLastLogEvents(e){ArktsBaseLogger.lastLogEvents.push(...e)}static getLastLogEvents(){return ArktsBaseLogger.lastLogEvents}static getPluginLogger(e){return ArktsBaseLogger.getLogger(e,constants_js_1.PLUGIN_LOG_TYPE)}static getLogger(e,s=constants_js_1.NORMAL_LOG_TYPE){return ArktsBaseLogger._logMap.has(e)||ArktsBaseLogger._logMap.set(e,new LogCore(e,s)),ArktsBaseLogger._logMap.get(e)}static getLogMap(){return ArktsBaseLogger._logMap}static addLogEvent(e){if(ArktsBaseLogger.checkTsWatchEnd(e)&&ArktsBaseLogger.tsWatchCb)return ArktsBaseLogger.tsWatchCb();ArktsBaseLogger._logEvents.push(e),"error"===e.level&&(this._logEventsHasError=!0),ArktsBaseLogger.sendLog&&ArktsBaseLogger.sendLog([e])}static getLogEvents(){return ArktsBaseLogger._logEvents}static checkLoggerHaveErrorInfo(){return this._logEventsHasError}static sendLastLogEvents(e){ArktsBaseLogger.sendLog&&ArktsBaseLogger.sendLog(ArktsBaseLogger.lastLogEvents,e)}static clearLogEvents(){for(const e of ArktsBaseLogger._logEvents)"string"!=typeof e.msg||"etsChecker"===e.category||"warn"!==e.level&&"error"!==e.level||ArktsBaseLogger.lastLogEvents.push(e);ArktsBaseLogger._logEvents.length=0,this._logEventsHasError=!1}static checkTsWatchEnd(e){return"string"==typeof e.msg&&"TS Watch End"===e.msg}static reset(){ArktsBaseLogger._logMap.clear(),ArktsBaseLogger.sendLog=void 0,ArktsBaseLogger.tsWatchCb=void 0,ArktsBaseLogger.lastLogEvents=[],ArktsBaseLogger.errorAdaptor=void 0}static setError(e){ArktsBaseLogger.errorAdaptor=void 0,e.type&&"none"!==e.type&&hvigor_logger_1.MATCH_FIELD_TYPES.includes(e.type)?ArktsBaseLogger.errorAdaptor=new hvigor_logger_1.ArkTsErrorAdaptor(e["checkMessage"===e.type?"message":e.type],"none"):ArktsBaseLogger.errorAdaptor=new hvigor_logger_1.ArkTsErrorAdaptor(e,"none")}}exports.ArktsBaseLogger=ArktsBaseLogger,ArktsBaseLogger._logMap=new Map,ArktsBaseLogger._logEvents=[],ArktsBaseLogger._logEventsHasError=!1,ArktsBaseLogger.sendLog=void 0,ArktsBaseLogger.tsWatchCb=void 0,ArktsBaseLogger.lastLogEvents=[];