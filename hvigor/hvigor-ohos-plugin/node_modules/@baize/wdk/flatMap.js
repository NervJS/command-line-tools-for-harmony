"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
var flatten_1 = __importDefault(require("./flatten"));
var identity_1 = __importDefault(require("./identity"));
var property_1 = __importDefault(require("./property"));
var keys_1 = __importDefault(require("./keys"));
/**
 * 对collection中每个元素调用iteratee映射为新值，得到一个新数组，返回该新数组扁平化后的数组
 * @param collection，要映射的数组
 * @param iteratee，用于对元素进行映射
 * @return 返回映射后且扁平化处理的新数组
 */
function flatMap(collection, iteratee) {
    // 真正用于映射的函数，如果iteratee是nullish则使用默认值identity
    var realIteratee = identity_1.default;
    var typeOfIteratee = typeof iteratee;
    if (typeOfIteratee === 'function') {
        realIteratee = iteratee;
    }
    else if (typeOfIteratee === 'string') {
        realIteratee = (0, property_1.default)(iteratee);
    }
    var collectionKeys = (0, keys_1.default)(collection);
    return (0, flatten_1.default)(collectionKeys.map(function (key) { return realIteratee(collection[key], key, collection); }));
}
exports.default = flatMap;
