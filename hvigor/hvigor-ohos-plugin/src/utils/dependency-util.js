"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.getDependenciesWithoutHar=exports.minimizeHspDependencies=exports.getJson5Obj=void 0;const hvigor_1=require("@ohos/hvigor"),dependency_interface_js_1=require("../project/dependency/core/dependency-interface.js"),file_util_js_1=require("./file-util.js"),parameter_utils_js_1=require("./parameter-utils.js"),fs_1=__importDefault(require("fs")),json5Map=hvigor_1.hvigorCore.getCache("JSON_CACHE");function getJson5Obj(e){var t;const n=fs_1.default.statSync(e).mtime.getTime();return(null===(t=json5Map.get(e))||void 0===t?void 0:t.timeStamp)!==n&&json5Map.set(e,{timeStamp:n,fileContent:hvigor_1.Json5Reader.getJson5Obj(e)}),json5Map.get(e).fileContent}function minimizeHspDependencies(e,t,n){(0,parameter_utils_js_1.getPropertyKeepDependency)()||(e.dependencies=getDependenciesWithoutHar(dependency_interface_js_1.DependencyEnum.DEPENDENCIES,t,n),e.dynamicDependencies=getDependenciesWithoutHar(dependency_interface_js_1.DependencyEnum.DYNAMIC_DEPENDENCIES,t,n),e.devDependencies&&delete e.devDependencies)}function getDependenciesWithoutHar(e,t,n){const i={},r=t.getHspDependencies().filter((t=>t.getDependencyEnum()===e));if(0===r.length)return{};const s={parameterFilePath:t.getProjectModel().getParameterFileAbsolutePath(),ohPackageFilePath:n};return r.forEach((e=>{const n=e.getDependencyName();i[n]=file_util_js_1.FileUtil.extracted(e.getDependedVersion(),t.getModuleModel().getParentProject().getParameterFileObj(),s)})),i}exports.getJson5Obj=getJson5Obj,exports.minimizeHspDependencies=minimizeHspDependencies,exports.getDependenciesWithoutHar=getDependenciesWithoutHar;