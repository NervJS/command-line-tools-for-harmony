"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.resolveVersionConflict2LockFile=void 0;const o=require("../registry/registry"),t=require("../dependency/util"),i=e(require("../../log"));exports.resolveVersionConflict2LockFile=function(e,r){e&&r&&(e.roughDepList.forEach((c=>{if(c.isRoot)return;if(c.isNativeSoType)return;const l=r.getMaxSatisfyingVersionData(c.name),n=l.pinnedSpec,s=c.registryType===o.RegistryType.local?c.fetchSpec:c.saveSpec,u=r.getLockSpec(e.moduleRootDir,c.name,s);r.deletePackage(e.moduleRootDir,u),r.updateLockSpec(e.moduleRootDir,c.name,s,n),r.updateLockPkg(e.moduleRootDir,c.name,n,(0,t.getLockPkgFromNodeData)(l)),i.default.debug("resolveConflict",`rewrite lockfile specifier ${c.name}@${s}: ${u} -> ${r.getLockSpec(e.moduleRootDir,c.name,s)} in ${e.moduleRootDir}`)})),r.clearVisitedSet(e.moduleRootDir))};