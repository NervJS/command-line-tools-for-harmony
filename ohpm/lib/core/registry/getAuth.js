"use strict";var e=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(s,c){function i(e){try{a(o.next(e))}catch(e){c(e)}}function r(e){try{a(o.throw(e))}catch(e){c(e)}}function a(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,r)}a((o=o.apply(e,t||[])).next())}))},t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.getAuth=void 0;const n=require("../../config/DefaultConfig"),o=require("../../config"),s=t(require("../../log")),c=require("../../common/Constants"),i=new Set;exports.getAuth=function(t,r=!1){return e(this,void 0,void 0,(function*(){let e;t.endsWith("/")||(t=t.concat("/"));const a=`${t=t.startsWith("http:")?t.substring("http:".length):t.substring("https:".length)}${n.AccessTokenType.READ}`,u=o.config.getString(a),f=`${t}${n.AccessTokenType.READ_WRITE}`,h=o.config.getString(f);e=r?h:u||h;const g=o.config.get(n.AccessTokenType.READ)?o.config.get(n.AccessTokenType.READ):o.config.get(n.AccessTokenType.READ_WRITE);if(!e&&g){const e=r?"readWrite":"readWrite or onlyRead",n=r?f:`${a} or ${f}`;!r&&!t.includes("/repos/ohpm")||i.has(n)||(s.default.warn(`fail to obtain accessToken in "${c.Constants.PmRc}" file:`,`need to create ${e} accessToken, the key of the accessToken should be set as "${n}" and the value cannot be empty.`),i.add(n))}return e||""}))};