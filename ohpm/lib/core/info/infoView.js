"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.infoView=void 0;const{columns:t}=require("../../tools/columnify/Columns"),i=require("../package/util"),o=require("../../tools/posh"),n=e(require("dayjs")),s=e(require("dayjs/plugin/relativeTime")),r=Math.floor;function a(e){const t=new Date(e).toLocaleString(),i=(0,n.default)(t).format("YYYY-MM-DD HH:mm:ss");return(0,n.default)(i).fromNow()}function l(e){return e.name+(e.email?` <${e.email}>`:"")+(e.url?` (${e.url})`:"")}n.default.extend(s.default,{thresholds:[{l:"s",r:1},{l:"m",r:1},{l:"mm",r:59,d:"minute"},{l:"h",r:1},{l:"hh",r:23,d:"hour"},{l:"d",r:1},{l:"dd",r:29,d:"day"},{l:"M",r:1},{l:"MM",r:11,d:"month"},{l:"y",r:1},{l:"yy",d:"year"}],rounding:r}),exports.infoView=function(e,n,s,r,u){var d;const p=[];var h;Object.keys(s).forEach((e=>{const t=s[e];p.push(`${o.posh.green(e)}: ${t}`)}));const m=function(e,t,i,n,s,r){return{name:o.posh.green(e.name),version:o.posh.green(e.version),versions:o.posh.yellow(`${t.length}`),description:e.description,deprecated:e.deprecated,keywords:(e.keywords||[]).map((e=>o.posh.yellow(e))),license:e.license||"Proprietary",deps:Object.keys(e.dependencies||{}).map((t=>`${o.posh.yellow(t)}: ${e.dependencies[t]}`)),publisher:e.author&&l({name:e.author.name?o.posh.yellow(e.author.name):"",email:e.author.email?o.posh.cyan(e.author.email):""}),modified:i?o.posh.yellow(a(i[e.version])):void 0,maintainers:(n||e.maintainers||[]).map((e=>l({name:e.name?o.posh.yellow(e.name):"",email:e.email?o.posh.cyan(e.email):""}))),repo:e.bugs&&e.bugs.url||e.repository&&e.repository.url,site:e.homepage,tags:r,tarball:o.posh.cyan(e.dist.tarball),shasum:e.dist.shasum?o.posh.yellow(e.dist.shasum):void 0,integrity:e.dist.integrity&&o.posh.yellow(e.dist.integrity),fileCount:e.dist.fileCount&&o.posh.yellow(e.dist.fileCount),unpackedSize:s&&`${o.posh.yellow(s.value)} ${s.unit}`}}(e,r,n,u,(null===(d=e.dist)||void 0===d?void 0:d.unpackedSize)&&((h=e.dist.unpackedSize)<1e3?{value:h,unit:"B"}:h<1e6?{value:(h/1e3).toFixed(1),unit:"KB"}:h<1e9?{value:(h/1e6).toFixed(1),unit:"MB"}:{value:(h/1e9).toFixed(1),unit:"GB"}),p);!function(e){"proprietary"===e.license.toLowerCase().trim()?e.license=o.posh.red(e.license):e.license=o.posh.green(e.license);const n=o.posh.underline.whiteBright(`${e.name}@${e.version}`),s=e.deps.length?o.posh.cyan(e.deps.length):o.posh.green("none");(0,i.output)(`\n${n} | ${e.license} | deps: ${s} | versions: ${e.versions}`),e.description&&(0,i.output)(e.description),(e.repo||e.site)&&e.site&&(0,i.output)(o.posh.cyan(e.site));e.deprecated&&(0,i.output)(`\n${o.posh.red("DEPRECATED")}!! - ${e.deprecated}`),e.keywords.length&&(0,i.output)(`\nkeywords: ${e.keywords.join(", ")}`),(0,i.output)("\ndist"),e.shasum?(0,i.output)(`.tarball: ${e.tarball}\n.shasum: ${e.shasum}`):(0,i.output)(`.tarball: ${e.tarball}`);e.integrity&&(0,i.output)(`.integrity: ${e.integrity}`),e.unpackedSize&&(0,i.output)(`.unpackedSize: ${e.unpackedSize}`);const r=24;e.deps.length&&((0,i.output)(`\ndependencies:\n${t.format(e.deps.slice(0,r),{padding:2})}`),e.deps.length>r&&(0,i.output)(`(...and ${e.deps.length-r} more.)`));e.maintainers&&e.maintainers.length&&((0,i.output)("\nmaintainers:"),e.maintainers.forEach((e=>(0,i.output)(`-${e}`))));if((0,i.output)(`\ndist-tags: \n${t.format(e.tags)}`),e.publisher||e.modified){let t="published";e.modified&&(t+=` ${e.modified}`),e.publisher&&(t+=` by ${e.publisher}`),(0,i.output)(`\n${t}`)}}(m)};