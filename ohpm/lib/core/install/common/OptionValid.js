"use strict";var t=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.validInitOptions=exports.validDistTagsOptions=exports.validListOptions=exports.validVersionOptions=exports.validRequestOptions=exports.validUpdateOptions=exports.validUnInstallOptions=exports.validInstallOptions=exports.validParameterFileOptions=exports.validPrefixOptions=exports.validPublishBaseOptions=exports.validFetchOptions=void 0;const e=require("./definitions"),i=require("../../../config"),r=require("../../../common/message"),o=t(require("path")),s=require("../../../util"),a=require("../../package/util"),n=require("../../install-targets/TargetManager"),l=require("../../audit");function p(t,e){if(e.registry){const r=i.config.validCli(i.types.REGISTRY,`${e.registry}`);if(r)throw new Error(`${t}${r}`)}}function u(t,e){let r;if(d(t,e),e.max_concurrent&&(r=i.config.validCli(i.types.MAX_CONCURRENT,`${e.max_concurrent}`),r))throw new Error(`${t}${r}`);if(e.retry_times&&(r=i.config.validCli(i.types.RETRY_TIMES,`${e.retry_times}`),r))throw new Error(`${t}${r}`);if(e.retry_interval&&(r=i.config.validCli(i.types.RETRY_INTERVAL,`${e.retry_interval}`),r))throw new Error(`${t}${r}`)}function d(t,e){let r;if(e.fetch_timeout&&(r=i.config.validCli(i.types.FETCH_TIMEOUT,`${e.fetch_timeout}`),r))throw new Error(`${t}${r}`);if(e.strict_ssl&&(r=i.config.validCli(i.types.STRICT_SSL,`${e.strict_ssl}`),r))throw new Error(`${t}${r}`)}function f(t,e){d(t,e),function(t,e){let r;if(e&&(r=i.config.validCli(i.types.PUBLISH_ID,e),r))throw new Error(`${t}${r}`)}(t,e.publish_id),function(t,e){let r;if(e&&(r=i.config.validCli(i.types.KEY_PATH,e),r))throw new Error(`${t}${r}`)}(t,e.key_path)}function c(t,e){if(e.prefix){const o=i.config.validCli(i.types.LOCAL_PREFIX,`${e.prefix}`);if(o)throw new Error(`${t}${o}`);if(!i.config.checkPkgDir(e.prefix))throw new Error(`${t} - invalid prefix value, ${r.Messages.Common.PkgNotFound}`);i.config.setLocalPrefix(e.prefix),i.config.loadProjectConfig()}}function g(t,e){if(!e||!e.parameterFile)return;let a;if(a=o.default.isAbsolute(e.parameterFile)?e.parameterFile:o.default.resolve(i.config.getProjectRoot(),e.parameterFile),!s.FsBlockingUtil.existsSync(a))throw new Error(r.Messages.Parameterization.CliInputParameterFileNotExist);i.config.setParameterFilePath(a)}exports.validFetchOptions=d,exports.validPublishBaseOptions=f,exports.validPrefixOptions=c,exports.validParameterFileOptions=g,exports.validInstallOptions=function(t,i){c(t,i),g(0,i),p(t,i),d(t,i),u(t,i),n.TargetManager.getInstance().validateTargetPath(i.target_path);const r={useNoLink:void 0===i.link?!e.defaultInstallOptions.link:!i.link};l.auditParamsManager.add(r)},exports.validUnInstallOptions=function(t,e){c(t,e),p(t,e),d(t,e)},exports.validUpdateOptions=function(t,e){if(c(t,e),p(t,e),d(t,e),u(t,e),e.tagFilter)try{e.tagFilter=new RegExp(e.tagFilter)}catch(t){throw new Error((0,r.format)(r.Messages.Update.TagFilterNonStandardRegex,{tagFilter:e.tagFilter,error:t.message}))}e.allModules=!!e.tagFilter||e.allModules,e.all=!!e.allModules||e.all;const i={useAllModules:!!e.allModules,useTagFilter:!!e.tagFilter};l.auditParamsManager.add(i)},exports.validRequestOptions=function(t,e){p(t,e),d(t,e)},exports.validVersionOptions=function(t,e){c(t,e),g(0,e)},exports.validListOptions=function(t,e){c(t,e),g(0,e)},exports.validDistTagsOptions=function(t,e){f(t,e),p(t,e)},exports.validInitOptions=function(t,e){if(e.group&&!a.groupReg.test(e.group))throw new Error('The group name must start with a lowercase letter and consist only of lowercase letters, numbers, "-", and "_"; it\'s length must not exceed 36 characters.')};