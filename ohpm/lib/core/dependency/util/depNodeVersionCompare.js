"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.depNodeVersionCompare=void 0;const r=require("./isLocalDependency"),n=e(require("semver")),t=require("../../install-targets/TargetManager"),o=require("../../../common/message"),a=e(require("../../../log"));function i(e,r){return e&&!r?1:!e&&r?-1:0}function s(e){var r;return null===(r=n.default.parse(e))||void 0===r?void 0:r.build.join("")}exports.depNodeVersionCompare=function(e,c){const u=s(e.version),d=s(c.version);return function(e,r,n,i){if(!e&&!n)return;if(t.TargetManager.getInstance().hasTarget()){const a=t.TargetManager.getInstance().getTargetName();if(e&&e!==a)throw new Error((0,o.format)(o.Messages.Target.InvalidTargetError,{targetName:e,version:`${r.name}@${r.version}`,defaultTarget:a}));if(n&&n!==a)throw new Error((0,o.format)(o.Messages.Target.InvalidTargetError,{targetName:n,version:`${i.name}@${i.version}`,defaultTarget:a}))}else e&&n&&e!==n&&a.default.warn("",`Found two targets: "${e}" in ${r.name}@${r.version}, ${n} in ${i.name}@${i.version} while conflict version resolve, please check whether the configuration is correct.`)}(u,e,d,c),(0,r.isLocalDependency)(e.pinnedSpec)&&(0,r.isLocalDependency)(c.pinnedSpec)?n.default.eq(e.version,c.version)?i(u,d):n.default.gtr(e.version,c.version)?1:-1:(0,r.isLocalDependency)(c.pinnedSpec)?-1:(0,r.isLocalDependency)(e.pinnedSpec)?1:n.default.eq(e.version,c.version)?i(u,d):n.default.gtr(e.version,c.version)?1:-1};