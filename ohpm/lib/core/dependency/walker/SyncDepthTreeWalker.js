"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SyncDepthTreeWalker=void 0;const e=require("./DependencyTreeWalker"),t=require("../../../common/Constants");class n extends e.AbstractAsyncTreeWalker{constructor(e,t=1/0){super(e),this.targetDepth=t}get context(){return this._context}walk(e){const n=this.context.tree,o=(r,s)=>{if(r)if(s.add(r.node.nodeKey),e.visit(r,this.context),r.depth>=this.targetDepth||!r.node.requirements||0===Object.keys(r.node.requirements).length)s.delete(r.node.nodeKey);else{for(const e of Object.keys(r.node.requirements)){const c=r.node.requirements[e];let d=n.pickNode(e,c.spec,r.node);if(d.packageType===t.Constants.HSPPackageType&&(d=n.pickMaxVersion(e)),s.has(d.nodeKey))continue;const i={node:d,depth:r.depth+1,children:[]};r.children||(r.children=[]),r.children.push(i),o(i,s)}s.delete(r.node.nodeKey)}};o(this._context.walkerRootNode,new Set)}}exports.SyncDepthTreeWalker=n;