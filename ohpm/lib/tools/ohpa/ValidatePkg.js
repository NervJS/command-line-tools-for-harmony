"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.validatePkg=void 0;const e=require("../../common/message"),t=["oh_modules","node_modules"];exports.validatePkg=new class{constructor(){this.REGEX_NAME_FULL=/^(?:@([^/]+?)\/)?([^/]+?)$/,this.REGEX_INVALID_START_CHAR=/^[._]/,this.REGEX_INVALID_CHARACTERS=/[~'!()*]/,this.MAX_LEN_NAME=214}validate(r){if(!r||!r.length)return(0,e.format)(e.Messages.Ohpa.NameEmptyError);if(r.length>this.MAX_LEN_NAME)return(0,e.format)(e.Messages.Ohpa.NameTooLongError);if(r.trim()!==r)return(0,e.format)(e.Messages.Ohpa.NameWithBlankError);if(encodeURIComponent(r)!==r){const t=r.match(this.REGEX_NAME_FULL);if(t){const r=t[1],s=t[2];if(encodeURIComponent(r)!==r||encodeURIComponent(s)!==s)return(0,e.format)(e.Messages.Ohpa.NameUriError)}}return this.REGEX_INVALID_START_CHAR.test(r)?(0,e.format)(e.Messages.Ohpa.NameInvalidStartError):this.REGEX_INVALID_CHARACTERS.test(r.split("/").slice(-1)[0])?(0,e.format)(e.Messages.Ohpa.NameWithSpecialError):t.includes(r.toLowerCase())?(0,e.format)(e.Messages.Ohpa.NameInBlacklistError,{name:r}):""}};