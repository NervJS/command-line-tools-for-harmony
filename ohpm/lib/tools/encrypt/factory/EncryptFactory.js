"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EncryptFactory=void 0;const t=require("../EncryptType"),r=require("../impl/AESEncrypt"),e=require("../../../core/audit/utils/HexUtils");class n{static encrypt(t,r,y,c){const p=n.getEncrypterByType(y).encrypt(t,e.HexUtils.generateRandomIv(),Buffer.from(r,"utf-8"),c);return e.HexUtils.byteArray2HexString(Array.from(p))}static decrypt(t,r,y,c){return n.getEncrypterByType(y).decrypt(t,Buffer.from(e.HexUtils.hexString2ByteArray(e.HexUtils.getIvFromContent(r))),Buffer.from(e.HexUtils.hexString2ByteArray(e.HexUtils.getEncryptContent(r))),c)}static getEncrypterByType(e){if(e===t.EncryptType.AES)return r.AESEncrypt.getInstance();throw new Error("unsupported encryption algorithm!")}}exports.EncryptFactory=n;